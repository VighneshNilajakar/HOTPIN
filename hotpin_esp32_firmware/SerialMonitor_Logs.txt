PS F:\Documents\HOTPIN\hotpin_esp32_firmware> idf.py monitor
Executing action: monitor
Serial port COM7
Connecting........
Detecting chip type... Unsupported detection protocol, switching and trying again...
Connecting...
Detecting chip type... ESP32
Running idf_monitor in directory F:\Documents\HOTPIN\hotpin_esp32_firmware
Executing "C:\Espressif\python_env\idf5.4_py3.11_env\Scripts\python.exe C:\Espressif\frameworks\esp-idf-v5.4.2\tools/idf_monitor.py -p COM7 -b 115200 --toolchain-prefix xtensa-esp32-elf- --target esp32 --revision 0 F:\Documents\HOTPIN\hotpin_esp32_firmware\build\hotpin_esp32_firmware.elf --force-color -m 'C:\Espressif\python_env\idf5.4_py3.11_env\Scripts\python.exe' 'C:\Espressif\frameworks\esp-idf-v5.4.2\tools\idf.py'"...
--- Warning: GDB cannot open serial ports accessed as COMx
--- Using \\.\COM7 instead...
--- esp-idf-monitor 1.7.0 on \\.\COM7 115200
--- Quit: Ctrl+] | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H
I (13) boot: ESP-IDF v5.4.2-dirty 2nd stage bootloader
I (13) boot: compile time Oct 20 2025 00:19:27
I (13) boot: Multicore bootloader
I (14) boot: chip revision: v3.1
I (17) boot.esp32: SPI Speed      : 40MHz
I (21) boot.esp32: SPI Mode       : DIO
I (24) boot.esp32: SPI Flash Size : 2MB
I (28) boot: Enabling RNG early entropy source...
I (32) boot: Partition Table:
I (35) boot: ## Label            Usage          Type ST Offset   Length
I (41) boot:  0 nvs              WiFi data        01 02 00009000 00004000
I (48) boot:  1 otadata          OTA data         01 00 0000d000 00002000
I (54) boot:  2 phy_init         RF data          01 01 0000f000 00001000
I (61) boot:  3 factory          factory app      00 00 00010000 00180000
I (67) boot:  4 storage          Unknown data     01 81 00190000 00070000
I (74) boot: End of partition table
I (77) boot: Defaulting to factory image
I (81) esp_image: segment 0: paddr=00010020 vaddr=3f400020 size=36a0ch (223756) map
I (165) esp_image: segment 1: paddr=00046a34 vaddr=3ff80000 size=0001ch (    28) load
I (165) esp_image: segment 2: paddr=00046a58 vaddr=3ffb0000 size=095c0h ( 38336) load
I (182) esp_image: segment 3: paddr=00050020 vaddr=400d0020 size=bacb0h (765104) map
I (444) esp_image: segment 4: paddr=0010acd8 vaddr=3ffb95c0 size=08704h ( 34564) load
I (457) esp_image: segment 5: paddr=001133e4 vaddr=40080000 size=1adf0h (110064) load
I (516) boot: Loaded app from partition at offset 0x10000
I (516) boot: Disabling RNG early entropy source...
I (527) quad_psram: This chip is ESP32-D0WD
I (527) esp_psram: Found 4MB PSRAM device
I (527) esp_psram: Speed: 40MHz
I (530) esp_psram: PSRAM initialized, cache is in low/high (2-core) mode.
I (538) cpu_start: Multicore app
I (1432) esp_psram: SPI SRAM memory test OK
I (1440) cpu_start: Pro cpu start user code
I (1440) cpu_start: cpu freq: 240000000 Hz
I (1440) app_init: Application information:
I (1443) app_init: Project name:     hotpin_esp32_firmware
I (1450) app_init: App version:      d76277e-dirty
I (1455) app_init: Compile time:     Oct 20 2025 00:19:16
I (1461) app_init: ELF file SHA256:  69b07a238...
I (1466) app_init: ESP-IDF:          v5.4.2-dirty
I (1472) efuse_init: Min chip rev:     v0.0
I (1477) efuse_init: Max chip rev:     v3.99
I (1482) efuse_init: Chip rev:         v3.1
I (1487) heap_init: Initializing. RAM available for dynamic allocation:
I (1494) heap_init: At 3FFAE6E0 len 00001920 (6 KiB): DRAM
I (1500) heap_init: At 3FFC9360 len 00016CA0 (91 KiB): DRAM
I (1506) heap_init: At 3FFE0440 len 00003AE0 (14 KiB): D/IRAM
I (1513) heap_init: At 3FFE4350 len 0001BCB0 (111 KiB): D/IRAM
I (1519) heap_init: At 4009ADF0 len 00005210 (20 KiB): IRAM
I (1526) esp_psram: Adding pool of 4096K of PSRAM memory to heap allocator
I (1534) spi_flash: detected chip: generic
I (1538) spi_flash: flash io: dio
W (1542) spi_flash: Detected size(4096k) larger than the size in the binary image header(2048k). Using the size in the binary image header.
I (1556) main_task: Started on CPU0
I (1559) esp_psram: Reserving pool of 32K of internal memory for DMA/internal allocations
I (1568) main_task: Calling app_main()
I (1572) HOTPIN_MAIN: ====================================
I (1578) HOTPIN_MAIN: HotPin ESP32-CAM AI Agent Starting
I (1584) HOTPIN_MAIN: ====================================
W (1590) HOTPIN_MAIN: Brownout detector disabled
I (1595) HOTPIN_MAIN: Validating PSRAM...
I (1600) HOTPIN_MAIN: PSRAM detected: 4194304 bytes (4.00 MB)
I (1607) HOTPIN_MAIN: PSRAM validation passed
I (1612) HOTPIN_MAIN: ====================================
I (1618) HOTPIN_MAIN: System Information:
I (1622) HOTPIN_MAIN: Chip: esp32
I (1626) HOTPIN_MAIN: Cores: 2
I (1630) HOTPIN_MAIN: Silicon revision: 301
I (1635) HOTPIN_MAIN: CPU Frequency: 240 MHz
I (1640) HOTPIN_MAIN: Flash: 2 MB external
I (1645) HOTPIN_MAIN: Free heap: 4365132 bytes
I (1650) HOTPIN_MAIN: PSRAM: 4194304 bytes
I (1655) HOTPIN_MAIN: ====================================
I (1661) HOTPIN_MAIN: Initializing NVS...
I (1690) HOTPIN_MAIN: NVS initialized successfully
I (1691) event_dispatcher: System event queue ready (16 entries)
I (1692) HOTPIN_MAIN: Synchronization primitives created
I (1698) HOTPIN_MAIN: Initializing WiFi...
I (1707) wifi:wifi driver task: 3ffd9f58, prio:23, stack:6656, core=0
I (1719) wifi:wifi firmware version: bea31f3
I (1720) wifi:wifi certification version: v7.0
I (1720) wifi:config NVS flash: enabled
I (1720) wifi:config nano formatting: disabled
I (1725) wifi:Init data frame dynamic rx buffer num: 32
I (1730) wifi:Init static rx mgmt buffer num: 5
I (1734) wifi:Init management short buffer num: 32
I (1738) wifi:Init dynamic tx buffer num: 32
I (1742) wifi:Init static rx buffer size: 1600
I (1747) wifi:Init static rx buffer num: 16
I (1750) wifi:Init dynamic rx buffer num: 32
I (1756) wifi_init: rx ba win: 6
I (1758) wifi_init: accept mbox: 6
I (1762) wifi_init: tcpip mbox: 32
I (1766) wifi_init: udp mbox: 6
I (1770) wifi_init: tcp mbox: 6
I (1774) wifi_init: tcp tx win: 5760
I (1778) wifi_init: tcp rx win: 5760
I (1783) wifi_init: tcp mss: 1440
I (1787) wifi_init: WiFi IRAM OP enabled
I (1791) wifi_init: WiFi RX IRAM OP enabled
I (1798) phy_init: phy_version 4860,6b7a6e5,Feb  6 2025,14:47:07
I (1865) phy_init: Saving new calibration data due to checksum failure or outdated calibration data, mode(0)
I (1930) wifi:mode : sta (80:f3:da:99:8c:64)
I (1930) wifi:enable tsf
I (1933) HOTPIN_MAIN: WiFi initialization complete, connecting to wifi...
I (1934) HOTPIN_MAIN: Waiting for WiFi connection...
I (1934) HOTPIN_MAIN: WiFi station started, connecting...
I (1956) wifi:new:<11,0>, old:<1,0>, ap:<255,255>, sta:<11,0>, prof:1, snd_ch_cfg:0x0
I (1958) wifi:state: init -> auth (0xb0)
I (3088) wifi:state: auth -> assoc (0x0)
I (3097) wifi:state: assoc -> run (0x10)
I (3119) wifi:connected with wifi, aid = 3, channel 11, BW20, bssid = ee:d4:b9:ed:90:50
I (3120) wifi:security: WPA3-SAE, phy: bgn, rssi: -78
I (3124) wifi:pm start, type: 1

I (3124) wifi:dp: 1, bi: 102400, li: 3, scale listen interval from 307200 us to 307200 us
I (3134) wifi:dp: 2, bi: 102400, li: 4, scale listen interval from 307200 us to 409600 us
I (3140) wifi:AP's beacon interval = 102400 us, DTIM period = 2
I (3147) wifi:<ba-add>idx:0 (ifx:0, ee:d4:b9:ed:90:50), tid:0, ssn:0, winSize:64
I (3155) HOTPIN_MAIN: WiFi connected to AP
I (4189) esp_netif_handlers: sta ip: 10.184.66.214, mask: 255.255.255.0, gw: 10.184.66.113
I (4190) HOTPIN_MAIN: âœ… Got IP address: 10.184.66.214
I (4194) HOTPIN_MAIN: WiFi ready - WebSocket connection task will handle server connection
I (6948) HOTPIN_MAIN: Initializing button handler...
I (6948) BUTTON: Initializing button handler on GPIO 4
I (6949) gpio: GPIO[4]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:3
I (6958) BUTTON: Button FSM task started
I (6963) BUTTON: Button handler initialized successfully (initial level=1, primed=1)
I (6971) HOTPIN_MAIN: Initializing LED controller...
I (6976) LED_CTRL: Initializing LED controller on GPIO 33
I (6983) LED_CTRL: LED controller ready
I (6987) LED_CTRL: LED pattern -> 2
I (6991) HOTPIN_MAIN: Initializing WebSocket client...
I (6997) WEBSOCKET: Initializing WebSocket client...
I (7002) WEBSOCKET: Server URI: ws://10.184.66.58:8000/ws
I (7009) WEBSOCKET: Authorization header configured
I (7016) WEBSOCKET: âœ… WebSocket client initialized
I (7020) WEBSOCKET: Status callback registered
I (7025) HOTPIN_MAIN: WebSocket status callback registered
I (7031) HOTPIN_MAIN: Initializing HTTP client...
I (7036) HTTP_CLIENT: Initializing HTTP client
I (7041) HTTP_CLIENT: Authorization token configured
I (7047) HTTP_CLIENT: HTTP client initialized (server: http://10.184.66.58:8000)
I (7055) HOTPIN_MAIN: Initializing STT pipeline...
I (7061) STT: Initializing STT pipeline...
I (7065) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7084) STT: â•‘ STT Ring Buffer Allocation (PSRAM)
I (7089) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7108) STT: [MEMORY] Pre-allocation state:
I (7112) STT:   Free internal RAM: 150759 bytes
I (7118) STT:   Free DMA-capable: 130487 bytes
I (7123) STT:   Free PSRAM: 4191564 bytes
I (7127) STT: [ALLOCATION] Allocating 64 KB ring buffer in external PSRAM...
I (7135) STT:   âœ“ Ring buffer allocated at 0x3f800ab8 (PSRAM address)
I (7143) STT:   âœ“ Confirmed: Buffer is in PSRAM address range (0x3F800000-0x3FC00000)
I (7151) STT: [MEMORY] Post-allocation state:
I (7156) STT:   Free internal RAM: 150759 bytes
I (7161) STT:   Free DMA-capable: 130487 bytes
I (7167) STT:   Free PSRAM: 4126024 bytes
I (7178) STT: [CORE AFFINITY] Creating persistent audio streaming task on Core 0
I (7179) STT: Persistent audio streaming task started on Core 0
I (7186) STT:   âœ“ Stream buffer allocated at 0x3ffd3808 (with safety padding)
I (7194) STT: âœ… STT pipeline initialized
I (7199) HOTPIN_MAIN: Initializing TTS decoder...
I (7204) TTS: Initializing TTS decoder...
I (7209) TTS: Allocating 65536 byte PSRAM buffer for TTS stream
I (7228) WEBSOCKET: Audio callback registered
I (7228) TTS: âœ… TTS decoder initialized
I (7229) HOTPIN_MAIN: Camera and audio initialization deferred to state manager
I (7235) HOTPIN_MAIN: Creating FreeRTOS tasks...
I (7241) HOTPIN_MAIN: State manager task created on Core 1
I (7241) STATE_MGR: State manager task started on Core 1
I (7247) HOTPIN_MAIN: WebSocket connection task started on Core 0
I (7253) STATE_MGR: Priority: 10
I (7260) HOTPIN_MAIN: ğŸ”Œ Attempting WebSocket connection (attempt 1)...
I (7263) STATE_MGR: Starting in camera mode...
I (7271) WEBSOCKET: Connecting to WebSocket server...
I (7276) STATE_MGR: === TRANSITION TO CAMERA MODE ===
I (7287) STATE_MGR: Acquiring I2S mutex...
I (7290) websocket_client: Started
I (7292) STATE_MGR: Audio drivers already inactive; skipping deinit
I (7296) WEBSOCKET: WebSocket client started
I (7303) STATE_MGR: Initializing camera...
I (7247) HOTPIN_MAIN: WebSocket connection task created on Core 0
I (7313) CAMERA: Initializing camera...
I (7320) HOTPIN_MAIN: Initializing task watchdog (30s timeout)...
I (7325) gpio: GPIO[25]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:2
I (7332) HOTPIN_MAIN: State manager task added to watchdog
E (7341) gpio: gpio_install_isr_service(503): GPIO isr service already installed
I (7347) HOTPIN_MAIN: ====================================
I (7355) cam_hal: cam init ok
I (7361) HOTPIN_MAIN: System initialization complete!
I (7365) sccb-ng: pin_sda 26 pin_scl 27
I (7370) HOTPIN_MAIN: Entering camera standby mode...
I (7375) sccb-ng: sccb_i2c_port=1
I (7380) HOTPIN_MAIN: ====================================
I (7386) gpio: GPIO[32]| InputEn: 0| OutputEn: 1| OpenDrain: 0| Pullup: 0| Pulldown: 0| Intr:0
I (7434) camera: Camera PID=0x26 VER=0x42 MIDL=0x7f MIDH=0xa2
I (7434) camera: Detected OV2640 camera
I (7434) camera: Detected camera at address=0x30
I (7514) cam_hal: PSRAM DMA mode disabled
I (7515) cam_hal: buffer_size: 32768, half_buffer_size: 4096, node_buffer_size: 2048, node_cnt: 16, total_cnt: 15
I (7519) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (7525) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (7532) cam_hal: cam config ok
I (7536) ov2640: Set PLL: clk_2x: 0, clk_div: 0, pclk_auto: 0, pclk_div: 8
I (7618) CAMERA: Camera initialized successfully
I (7618) STATE_MGR: I2S mutex released
I (7618) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7618) STATE_MGR: âœ… Camera mode transition complete
I (7636) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (7641) STATE_MGR: âœ… Entered CAMERA_STANDBY state
I (7653) LED_CTRL: LED pattern -> 3
I (7648) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7667) WEBSOCKET: âœ… WebSocket connected to server
I (7675) AUDIO: [MUTEX] Creating I2S access mutex for thread safety...
I (7682) WEBSOCKET: Sending handshake: {"session_id":"esp32-cam-hotpin"}
I (7688) AUDIO:   âœ“ I2S access mutex created successfully
I (7699) WEBSOCKET: Handshake sent successfully
I (7707) HOTPIN_MAIN: ğŸ‰ WebSocket status callback: CONNECTED
I (7707) STATE_MGR: WebSocket connected
I (7702) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7736) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (7743) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7761) AUDIO: [DIAG] Pre-init state:
I (7766) AUDIO:   Free heap: 3982804 bytes
I (7770) AUDIO:   Free internal RAM: 67051 bytes
I (7776) AUDIO:   Free DMA-capable: 46779 bytes
I (7781) AUDIO:   Free PSRAM: 3936032 bytes
I (7786) AUDIO:   Timestamp: 6260 ms
I (7790) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (7797) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (7805) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (7813) AUDIO:   DMA frame num (per desc): 1020
I (7818) AUDIO:   DMA total samples (effective): 4080
I (7824) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (7831) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (7837) AUDIO: âœ… I2S channels created (took 0 ms)
I (7842) AUDIO:   TX handle: 0x3ffe1c10 | RX handle: 0x3fff4ba0
I (7849) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (7851) WEBSOCKET: Received text message: {"status": "connected", "session_id": "esp32-cam-hotpin"}
I (7855) AUDIO:   Sample rate: 16000 Hz
I (7866) WEBSOCKET: Server status: connected
I (7870) AUDIO:   MCLK: DISABLED
I (7879) AUDIO:   BCLK: GPIO14 (shared)
I (7883) AUDIO:   WS:   GPIO15 (shared)
I (7888) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (7895) AUDIO: âœ… TX channel configured (took 1 ms)
I (7899) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (7906) AUDIO:   Sample rate: 16000 Hz
I (7910) AUDIO:   MCLK: DISABLED
I (7914) AUDIO:   BCLK: GPIO14 (shared)
I (7919) AUDIO:   WS:   GPIO15 (shared)
I (7923) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (7929) AUDIO: âœ… RX channel configured (took 0 ms)
I (7934) AUDIO: [STEP 4/6] Enabling TX channel...
I (7940) AUDIO: âœ… TX channel enabled (took 0 ms)
I (7945) AUDIO: [STEP 5/6] Enabling RX channel...
I (7951) AUDIO: âœ… RX channel enabled (took 0 ms)
I (7956) AUDIO: [STEP 6/6] Hardware stabilization...
I (7962) AUDIO:   Phase 1: Initial settle (50ms)
I (7715) HOTPIN_MAIN: ğŸ“¡ WebSocket connection active - monitoring link
I (8017) AUDIO:   Phase 2: DMA verification
I (8017) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (8017) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (8174) AUDIO: [DIAG] Post-init state:
I (8174) AUDIO:   Free heap: 3959940 bytes
I (8174) AUDIO:   Free internal RAM: 44187 bytes
I (8177) AUDIO:   Free DMA-capable: 23915 bytes
I (8183) AUDIO:   Free PSRAM: 3936032 bytes
I (8188) AUDIO:   Timestamp: 6662 ms
I (8192) AUDIO:   Total init time: 201 ms
I (8196) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (8214) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (8220) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (8226) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (8234) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (8241) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (8259) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (8277) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (8283) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (8290) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (8296) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (8302) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9586) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9593) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (9600) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9618) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (9625) AUDIO: âœ… RX channel disabled (took 0 ms)
I (9630) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (9637) AUDIO: âœ… TX channel disabled (took 0 ms)
I (9642) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (9699) AUDIO: [STEP 4/5] Deleting RX channel...
I (9699) AUDIO: âœ… RX channel deleted (took 0 ms)
I (9699) AUDIO: [STEP 5/5] Deleting TX channel...
I (9704) AUDIO: âœ… TX channel deleted (took 0 ms)
I (9709) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (9767) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9773) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (9780) AUDIO: â•‘ Camera Can Now Initialize
I (9785) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9803) HOTPIN_MAIN: Main task exiting - system running
I (9809) main_task: Returned from app_main()
I (12327) BUTTON: Single click confirmed
I (12327) STATE_MGR: Button event received: 1 in state CAMERA_STANDBY
I (12328) STATE_MGR: Single click - mode toggle requested
I (12334) STATE_MGR: Switching: Camera â†’ Voice (count: 1)
I (12390) STATE_MGR: === TRANSITION TO VOICE MODE ===
I (12390) STATE_MGR: Stopping camera...
I (12390) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12405) STATE_MGR: â•‘ STEP 2: Acquiring I2S configuration mutex
I (12412) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12428) STATE_MGR:   Timeout: 5000 ms
I (12433) STATE_MGR:   Timestamp: 10908 ms
I (12438) STATE_MGR:   âœ“ Mutex acquired (took 0 ms)
I (12443) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12460) STATE_MGR: â•‘ STEP 3: Deinitializing camera hardware
I (12466) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12482) STATE_MGR:   Free heap before: 3990720 bytes
I (12488) STATE_MGR:   Free PSRAM before: 3936032 bytes
I (12494) CAMERA: Deinitializing camera...
I (12500) CAMERA: Camera deinitialized
I (12503) STATE_MGR:   âœ“ Camera deinitialized (took 9 ms)
I (12510) STATE_MGR:   Free heap after: 4153124 bytes
I (12515) STATE_MGR:   Free PSRAM after: 4060348 bytes
I (12521) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12537) STATE_MGR: â•‘ HARDWARE STABILIZATION - CRITICAL
I (12544) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12560) STATE_MGR:   Phase 1: Initial settle (100ms) - Free camera interrupts
I (12668) STATE_MGR:   Phase 2: GPIO matrix settle (100ms) - Reconfigure pins
I (12768) STATE_MGR:   Phase 3: Final settle (50ms) - Stabilize state
I (12818) STATE_MGR:   âœ“ Total stabilization: 250ms
I (12818) STATE_MGR:   Timestamp: 11293 ms
I (12818) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12834) STATE_MGR: â•‘ STEP 4: Initializing I2S audio drivers
I (12841) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12857) STATE_MGR:   Free heap before: 4153124 bytes
I (12863) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12881) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (12888) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12906) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12924) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (12931) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (12949) AUDIO: [DIAG] Pre-init state:
I (12953) AUDIO:   Free heap: 4153124 bytes
I (12958) AUDIO:   Free internal RAM: 113055 bytes
I (12964) AUDIO:   Free DMA-capable: 92783 bytes
I (12969) AUDIO:   Free PSRAM: 4060348 bytes
I (12974) AUDIO:   Timestamp: 11449 ms
I (12978) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (12985) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (12993) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (13001) AUDIO:   DMA frame num (per desc): 1020
I (13007) AUDIO:   DMA total samples (effective): 4080
I (13013) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (13020) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (13026) AUDIO: âœ… I2S channels created (took 0 ms)
I (13031) AUDIO:   TX handle: 0x3ffafc3c | RX handle: 0x3ffca6d0
I (13038) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (13045) AUDIO:   Sample rate: 16000 Hz
I (13049) AUDIO:   MCLK: DISABLED
I (13053) AUDIO:   BCLK: GPIO14 (shared)
I (13058) AUDIO:   WS:   GPIO15 (shared)
I (13063) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (13069) AUDIO: âœ… TX channel configured (took 1 ms)
I (13074) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (13081) AUDIO:   Sample rate: 16000 Hz
I (13085) AUDIO:   MCLK: DISABLED
I (13089) AUDIO:   BCLK: GPIO14 (shared)
I (13094) AUDIO:   WS:   GPIO15 (shared)
I (13099) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (13105) AUDIO: âœ… RX channel configured (took 0 ms)
I (13110) AUDIO: [STEP 4/6] Enabling TX channel...
I (13116) AUDIO: âœ… TX channel enabled (took 0 ms)
I (13121) AUDIO: [STEP 5/6] Enabling RX channel...
I (13127) AUDIO: âœ… RX channel enabled (took 0 ms)
I (13132) AUDIO: [STEP 6/6] Hardware stabilization...
I (13138) AUDIO:   Phase 1: Initial settle (50ms)
I (13193) AUDIO:   Phase 2: DMA verification
I (13193) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (13194) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (13351) AUDIO: [DIAG] Post-init state:
I (13351) AUDIO:   Free heap: 4127144 bytes
I (13351) AUDIO:   Free internal RAM: 87075 bytes
I (13355) AUDIO:   Free DMA-capable: 66803 bytes
I (13360) AUDIO:   Free PSRAM: 4060348 bytes
I (13365) AUDIO:   Timestamp: 11840 ms
I (13370) AUDIO:   Total init time: 201 ms
I (13374) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13392) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (13399) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (13404) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (13413) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (13419) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13437) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13455) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (13462) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (13468) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (13475) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (13481) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13499) STATE_MGR:   âœ“ Audio initialized (took 636 ms)
I (13505) STATE_MGR:   Free heap after: 4127144 bytes
I (13511) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13527) STATE_MGR: â•‘ STEP 5: I2S mutex released
I (13533) STATE_MGR: â•‘ Total transition time: 895 ms
I (13539) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13555) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13571) STATE_MGR: â•‘ STEP 6: Starting STT/TTS pipelines
I (13578) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13594) STT: Starting STT pipeline...
I (13598) STT: [CORE AFFINITY] Creating audio capture task on Core 0 (co-located with Wi-Fi)
I (13608) STT: âœ… STT pipeline started
I (13607) STT: [STABILIZATION] Phase 1: Waiting 200ms for I2S DMA...
I (13619) STT:   Current time: 12094 ms
I (13608) STT: Audio streaming session activated
I (13629) STT: Starting audio streaming to server...
I (13623) STT:   Free heap: 4118592 bytes
I (13662) TTS: ğŸµ Starting TTS decoder...
I (13662) TTS: Initializing TTS decoder...
W (13663) TTS: TTS decoder already initialized
I (13666) TTS: [CORE AFFINITY] Creating TTS playback task on Core 1 (APP_CPU) with safety measures
I (13676) TTS: âœ… TTS decoder started successfully
I (13716) TTS: ğŸµ TTS playback task started on Core 1
I (13716) TTS:   âœ“ DMA buffer allocated in PSRAM at 0x3f820b48 (4096 bytes)
I (13839) STT: [STABILIZATION] Phase 2: Verify audio driver state...
I (13839) STT:   âœ“ Audio driver initialized
I (13840) STT: [STABILIZATION] Phase 3: Additional 100ms settle...
I (13947) STT:   Total stabilization: 300ms
I (13947) STT:   Timestamp: 12421 ms
I (13947) STT: [BUFFER] Allocating 1024 byte capture buffer...
I (13951) STT:   âœ“ DMA-capable buffer allocated at 0x3fff26ec (with safety padding)
I (13956) LED_CTRL: LED pattern -> 1
I (13960) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (13964) STATE_MGR: âœ… Voice mode transition complete
I (13980) STT: â•‘ ğŸ¤ STARTING AUDIO CAPTURE
I (13986) STATE_MGR: âœ… Entered VOICE_ACTIVE state
I (13991) STT: â•‘ Chunk size: 1024 bytes | Timeout: 100 ms
I (14003) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (14007) STATE_MGR: STT pipeline reported start
I (14034) STATE_MGR: TTS playback start event received
I (18305) BUTTON: Single click confirmed
I (18305) STATE_MGR: Button event received: 1 in state VOICE_ACTIVE
W (18306) STATE_MGR: Guardrail soft override: stopping voice pipeline while busy
I (18314) STATE_MGR: Single click - mode toggle requested
I (18320) STATE_MGR: Switching: Voice â†’ Camera (count: 2)
I (18376) STATE_MGR: === TRANSITION TO CAMERA MODE ===
I (18376) STATE_MGR: Stopping voice mode components...
I (18377) STT: Stopping STT pipeline...
I (18419) STT: Audio capture task stopped (captured 145408 bytes total)
I (18421) STT: Streaming task received stop signal
I (18422) STT: Sending EOS signal...
I (18426) WEBSOCKET: Sending EOS signal
I (18433) STT: Audio streaming session complete (streamed 144384 bytes in 36 chunks)
I (18440) STT: STT pipeline stopped
I (18510) WEBSOCKET: Received text message: {"status": "processing", "stage": "transcription"}
I (18511) WEBSOCKET: Server status: processing
I (18514) WEBSOCKET: Server stage: transcription
I (18519) WEBSOCKET: Pipeline stage changed: idle -> transcription
I (19109) WEBSOCKET: Received text message: {"status": "processing", "stage": "llm", "transcript": "hello"}
I (19110) WEBSOCKET: Server status: processing
I (19114) WEBSOCKET: Server stage: llm
I (19118) WEBSOCKET: Pipeline stage changed: transcription -> llm
I (19521) WEBSOCKET: Received text message: {"status": "processing", "stage": "tts", "response": "Hello, how can I assist you today?"}
I (19523) WEBSOCKET: Server status: processing
I (19528) WEBSOCKET: Server stage: tts
I (19532) WEBSOCKET: Pipeline stage changed: llm -> tts
I (19736) WEBSOCKET: Received binary audio data: 4096 bytes
I (19741) WEBSOCKET: Received binary audio data: 1203 bytes
I (19747) WEBSOCKET: Received binary audio data: 2880 bytes
I (19749) WEBSOCKET: Received binary audio data: 13 bytes
I (19755) WEBSOCKET: Received binary audio data: 1423 bytes
I (19758) WEBSOCKET: Received binary audio data: 2673 bytes
I (19760) TTS: âœ… WAV header parsed successfully
I (19768) TTS: === WAV File Info ===
I (19770) WEBSOCKET: Received binary audio data: 4096 bytes
I (19774) TTS: Sample Rate: 16000 Hz
I (19783) TTS: Channels: 1
I (19786) WEBSOCKET: Received binary audio data: 4096 bytes
I (19793) TTS: Bits per Sample: 16
I (19796) TTS: Audio Format: 1 (PCM)
I (19798) WEBSOCKET: Received binary audio data: 4096 bytes
I (19809) TTS: Declared Data Size: 94360 bytes
I (19812) TTS: Block Align: 2
I (19813) WEBSOCKET: Received binary audio data: 4096 bytes
I (19818) TTS: Byte Rate: 32000
I (19826) TTS: ====================
I (19829) WEBSOCKET: Received binary audio data: 4096 bytes
I (19842) WEBSOCKET: Received binary audio data: 4096 bytes
I (19849) WEBSOCKET: Received binary audio data: 4096 bytes
I (19854) WEBSOCKET: Received binary audio data: 303 bytes
I (19857) WEBSOCKET: Received binary audio data: 3793 bytes
I (19866) WEBSOCKET: Received binary audio data: 4096 bytes
I (19872) WEBSOCKET: Received binary audio data: 743 bytes
I (19876) WEBSOCKET: Received binary audio data: 3353 bytes
I (19887) WEBSOCKET: Received binary audio data: 4096 bytes
I (19894) WEBSOCKET: Received binary audio data: 4096 bytes
I (19896) TTS: ğŸ”” Playback start feedback dispatched (bytes_received=61440)
I (19900) WEBSOCKET: Received binary audio data: 1403 bytes
I (19908) WEBSOCKET: Received binary audio data: 2693 bytes
I (19916) TTS: [PCM DUP] Scratch buffer ready: 8192 bytes (2048 samples per block)
I (19920) WEBSOCKET: Received binary audio data: 4096 bytes
I (19932) WEBSOCKET: Received binary audio data: 4096 bytes
I (19938) WEBSOCKET: Received binary audio data: 623 bytes
I (19942) WEBSOCKET: Received binary audio data: 3473 bytes
I (19953) WEBSOCKET: Received binary audio data: 4096 bytes
I (19957) WEBSOCKET: Received binary audio data: 1063 bytes
I (19965) WEBSOCKET: Received binary audio data: 2880 bytes
I (19966) WEBSOCKET: Received binary audio data: 153 bytes
I (19976) WEBSOCKET: Received binary audio data: 4096 bytes
I (19982) WEBSOCKET: Received binary audio data: 1503 bytes
I (19985) WEBSOCKET: Received binary audio data: 2593 bytes
I (19993) WEBSOCKET: Received binary audio data: 196 bytes
I (19998) WEBSOCKET: Received text message: {"status": "complete"}
I (20003) WEBSOCKET: Server status: complete
I (20007) WEBSOCKET: Pipeline stage changed: tts -> complete
I (20043) STATE_MGR: Voice pipeline reported COMPLETE
I (20043) STATE_MGR: Waiting for TTS playback drain (~68495 bytes pending, timeout 5000 ms)
W (21975) TTS: Mono chunk size 2915 not aligned to 16-bit samples - writing raw
I (22038) TTS: [PCM PLAYBACK] Successfully wrote 2915 bytes to I2S driver (total: 2915 bytes)
W (25047) STATE_MGR: TTS playback drain timed out; proceeding with shutdown
I (25047) TTS: â¹ï¸ Stopping TTS decoder...
I (25089) TTS: EOS requested and stream buffer is empty. Exiting playback task.
I (25089) TTS: ğŸµ TTS playback task exiting (played 72503 bytes, result: ESP_OK)
I (25094) TTS:   âœ“ DMA buffer freed from PSRAM
I (25109) TTS: â¹ï¸ TTS decoder stopped (played 72503 bytes)
I (25209) STATE_MGR: Acquiring I2S mutex...
I (25209) STATE_MGR: Deinitializing audio drivers...
I (25210) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (25227) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (25234) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (25252) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (25259) AUDIO: âœ… RX channel disabled (took 0 ms)
I (25265) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (25271) AUDIO: âœ… TX channel disabled (took 0 ms)
I (25277) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (25333) AUDIO: [STEP 4/5] Deleting RX channel...
I (25334) AUDIO: âœ… RX channel deleted (took 0 ms)
I (25334) AUDIO: [STEP 5/5] Deleting TX channel...
I (25339) AUDIO: âœ… TX channel deleted (took 0 ms)
I (25344) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (25402) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (25409) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (25416) AUDIO: â•‘ Camera Can Now Initialize
I (25421) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (25439) STATE_MGR: Initializing camera...
I (25443) CAMERA: Initializing camera...
I (25448) gpio: GPIO[25]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:2
E (25458) gpio: gpio_install_isr_service(503): GPIO isr service already installed
I (25466) cam_hal: cam init ok
W (25470) ledc: GPIO 0 is not usable, maybe conflict with others
I (25476) sccb-ng: pin_sda 26 pin_scl 27
I (25481) sccb-ng: sccb_i2c_port=1
I (25486) gpio: GPIO[32]| InputEn: 0| OutputEn: 1| OpenDrain: 0| Pullup: 0| Pulldown: 0| Intr:0
I (25528) camera: Camera PID=0x26 VER=0x42 MIDL=0x7f MIDH=0xa2
I (25528) camera: Detected OV2640 camera
I (25528) camera: Detected camera at address=0x30
I (25608) cam_hal: PSRAM DMA mode disabled
I (25609) cam_hal: buffer_size: 32768, half_buffer_size: 4096, node_buffer_size: 2048, node_cnt: 16, total_cnt: 15
I (25613) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (25620) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (25626) cam_hal: cam config ok
I (25630) ov2640: Set PLL: clk_2x: 0, clk_div: 0, pclk_auto: 0, pclk_div: 8
I (25713) CAMERA: Camera initialized successfully
I (25713) STATE_MGR: I2S mutex released
I (25713) STATE_MGR: âœ… Camera mode transition complete
I (25718) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (25736) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (25743) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (25761) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (25779) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (25786) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (25804) AUDIO: [DIAG] Pre-init state:
I (25809) AUDIO:   Free heap: 3982368 bytes
I (25814) AUDIO:   Free internal RAM: 66615 bytes
I (25819) AUDIO:   Free DMA-capable: 46343 bytes
I (25824) AUDIO:   Free PSRAM: 3936032 bytes
I (25829) AUDIO:   Timestamp: 24304 ms
I (25834) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (25840) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (25848) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (25856) AUDIO:   DMA frame num (per desc): 1020
I (25862) AUDIO:   DMA total samples (effective): 4080
I (25868) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (25875) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (25881) AUDIO: âœ… I2S channels created (took 0 ms)
I (25887) AUDIO:   TX handle: 0x3ffcb5ec | RX handle: 0x3ffca8f4
I (25893) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (25900) AUDIO:   Sample rate: 16000 Hz
I (25905) AUDIO:   MCLK: DISABLED
I (25909) AUDIO:   BCLK: GPIO14 (shared)
I (25913) AUDIO:   WS:   GPIO15 (shared)
I (25918) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (25925) AUDIO: âœ… TX channel configured (took 1 ms)
I (25929) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (25936) AUDIO:   Sample rate: 16000 Hz
I (25941) AUDIO:   MCLK: DISABLED
I (25945) AUDIO:   BCLK: GPIO14 (shared)
I (25949) AUDIO:   WS:   GPIO15 (shared)
I (25954) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (25960) AUDIO: âœ… RX channel configured (took 0 ms)
I (25965) AUDIO: [STEP 4/6] Enabling TX channel...
I (25971) AUDIO: âœ… TX channel enabled (took 0 ms)
I (25976) AUDIO: [STEP 5/6] Enabling RX channel...
I (25982) AUDIO: âœ… RX channel enabled (took 0 ms)
I (25987) AUDIO: [STEP 6/6] Hardware stabilization...
I (25993) AUDIO:   Phase 1: Initial settle (50ms)
I (26048) AUDIO:   Phase 2: DMA verification
I (26048) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (26049) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (26206) AUDIO: [DIAG] Post-init state:
I (26206) AUDIO:   Free heap: 3956400 bytes
I (26206) AUDIO:   Free internal RAM: 40647 bytes
I (26210) AUDIO:   Free DMA-capable: 20375 bytes
I (26215) AUDIO:   Free PSRAM: 3936032 bytes
I (26220) AUDIO:   Timestamp: 24695 ms
I (26225) AUDIO:   Total init time: 201 ms
I (26229) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (26247) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (26254) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (26259) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (26268) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (26274) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (26292) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (26310) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (26317) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (26323) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (26330) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (26336) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (26637) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (26644) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (26652) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (26670) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (26677) AUDIO: âœ… RX channel disabled (took 0 ms)
I (26682) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (26689) AUDIO: âœ… TX channel disabled (took 0 ms)
I (26694) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (26751) AUDIO: [STEP 4/5] Deleting RX channel...
I (26752) AUDIO: âœ… RX channel deleted (took 0 ms)
I (26752) AUDIO: [STEP 5/5] Deleting TX channel...
I (26757) AUDIO: âœ… TX channel deleted (took 0 ms)
I (26762) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (26820) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (26827) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (26834) AUDIO: â•‘ Camera Can Now Initialize
I (26839) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (26857) LED_CTRL: LED pattern -> 3
I (26861) STATE_MGR: âœ… Entered CAMERA_STANDBY state
I (26877) STATE_MGR: STT pipeline reported stop
I (26887) STATE_MGR: Pipeline stage event: transcription
I (26897) STATE_MGR: Pipeline stage event: llm
I (26907) STATE_MGR: Pipeline stage event: tts
I (26917) STATE_MGR: Pipeline stage event: complete
I (34905) BUTTON: Single click confirmed
I (34905) STATE_MGR: Button event received: 1 in state CAMERA_STANDBY
I (34906) STATE_MGR: Single click - mode toggle requested
I (34912) STATE_MGR: Switching: Camera â†’ Voice (count: 3)
I (34968) STATE_MGR: === TRANSITION TO VOICE MODE ===
I (34968) STATE_MGR: Stopping camera...
I (34968) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (34984) STATE_MGR: â•‘ STEP 2: Acquiring I2S configuration mutex
I (34991) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35007) STATE_MGR:   Timeout: 5000 ms
I (35011) STATE_MGR:   Timestamp: 33486 ms
I (35016) STATE_MGR:   âœ“ Mutex acquired (took 0 ms)
I (35022) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35038) STATE_MGR: â•‘ STEP 3: Deinitializing camera hardware
I (35045) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35061) STATE_MGR:   Free heap before: 3982352 bytes
I (35067) STATE_MGR:   Free PSRAM before: 3936032 bytes
I (35072) CAMERA: Deinitializing camera...
I (35079) CAMERA: Camera deinitialized
I (35082) STATE_MGR:   âœ“ Camera deinitialized (took 9 ms)
I (35088) STATE_MGR:   Free heap after: 4144768 bytes
I (35094) STATE_MGR:   Free PSRAM after: 4060348 bytes
I (35100) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35116) STATE_MGR: â•‘ HARDWARE STABILIZATION - CRITICAL
I (35122) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35138) STATE_MGR:   Phase 1: Initial settle (100ms) - Free camera interrupts
I (35246) STATE_MGR:   Phase 2: GPIO matrix settle (100ms) - Reconfigure pins
I (35346) STATE_MGR:   Phase 3: Final settle (50ms) - Stabilize state
I (35396) STATE_MGR:   âœ“ Total stabilization: 250ms
I (35396) STATE_MGR:   Timestamp: 33871 ms
I (35396) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35412) STATE_MGR: â•‘ STEP 4: Initializing I2S audio drivers
I (35419) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35435) STATE_MGR:   Free heap before: 4144768 bytes
I (35441) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35459) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (35466) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35484) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35502) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (35509) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35527) AUDIO: [DIAG] Pre-init state:
I (35531) AUDIO:   Free heap: 4144768 bytes
I (35536) AUDIO:   Free internal RAM: 104699 bytes
I (35542) AUDIO:   Free DMA-capable: 84427 bytes
I (35547) AUDIO:   Free PSRAM: 4060348 bytes
I (35552) AUDIO:   Timestamp: 34027 ms
I (35556) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (35563) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (35571) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (35579) AUDIO:   DMA frame num (per desc): 1020
I (35585) AUDIO:   DMA total samples (effective): 4080
I (35591) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (35598) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (35604) AUDIO: âœ… I2S channels created (took 0 ms)
I (35609) AUDIO:   TX handle: 0x3ffafc3c | RX handle: 0x3ffcb4c0
I (35616) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (35623) AUDIO:   Sample rate: 16000 Hz
I (35627) AUDIO:   MCLK: DISABLED
I (35631) AUDIO:   BCLK: GPIO14 (shared)
I (35636) AUDIO:   WS:   GPIO15 (shared)
I (35641) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (35647) AUDIO: âœ… TX channel configured (took 1 ms)
I (35652) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (35659) AUDIO:   Sample rate: 16000 Hz
I (35663) AUDIO:   MCLK: DISABLED
I (35667) AUDIO:   BCLK: GPIO14 (shared)
I (35672) AUDIO:   WS:   GPIO15 (shared)
I (35677) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (35683) AUDIO: âœ… RX channel configured (took 0 ms)
I (35688) AUDIO: [STEP 4/6] Enabling TX channel...
I (35694) AUDIO: âœ… TX channel enabled (took 0 ms)
I (35699) AUDIO: [STEP 5/6] Enabling RX channel...
I (35705) AUDIO: âœ… RX channel enabled (took 0 ms)
I (35710) AUDIO: [STEP 6/6] Hardware stabilization...
I (35716) AUDIO:   Phase 1: Initial settle (50ms)
I (35771) AUDIO:   Phase 2: DMA verification
I (35771) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (35772) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (35929) AUDIO: [DIAG] Post-init state:
I (35929) AUDIO:   Free heap: 4118788 bytes
I (35929) AUDIO:   Free internal RAM: 78719 bytes
I (35933) AUDIO:   Free DMA-capable: 58447 bytes
I (35938) AUDIO:   Free PSRAM: 4060348 bytes
I (35943) AUDIO:   Timestamp: 34418 ms
I (35948) AUDIO:   Total init time: 201 ms
I (35952) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35970) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (35977) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (35982) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (35991) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (35997) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36015) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36033) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (36040) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (36046) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (36053) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (36059) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36077) STATE_MGR:   âœ“ Audio initialized (took 636 ms)
I (36083) STATE_MGR:   Free heap after: 4118788 bytes
I (36089) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36105) STATE_MGR: â•‘ STEP 5: I2S mutex released
I (36111) STATE_MGR: â•‘ Total transition time: 895 ms
I (36117) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36133) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36149) STATE_MGR: â•‘ STEP 6: Starting STT/TTS pipelines
I (36156) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36172) STT: Starting STT pipeline...
I (36176) STT: [CORE AFFINITY] Creating audio capture task on Core 0 (co-located with Wi-Fi)
I (36186) STT: âœ… STT pipeline started
I (36185) STT: [STABILIZATION] Phase 1: Waiting 200ms for I2S DMA...
I (36197) STT:   Current time: 34672 ms
I (36186) STT: Audio streaming session activated
I (36207) STT: Starting audio streaming to server...
I (36201) STT:   Free heap: 4110236 bytes
I (36240) TTS: ğŸµ Starting TTS decoder...
I (36240) TTS: Initializing TTS decoder...
W (36241) TTS: TTS decoder already initialized
I (36244) TTS: [CORE AFFINITY] Creating TTS playback task on Core 1 (APP_CPU) with safety measures
I (36254) TTS: âœ… TTS decoder started successfully
I (36294) TTS: ğŸµ TTS playback task started on Core 1
I (36294) TTS:   âœ“ DMA buffer allocated in PSRAM at 0x3f820b48 (4096 bytes)
I (36417) STT: [STABILIZATION] Phase 2: Verify audio driver state...
I (36417) STT:   âœ“ Audio driver initialized
I (36418) STT: [STABILIZATION] Phase 3: Additional 100ms settle...
I (36525) STT:   Total stabilization: 300ms
I (36525) STT:   Timestamp: 35000 ms
I (36525) STT: [BUFFER] Allocating 1024 byte capture buffer...
I (36529) STT:   âœ“ DMA-capable buffer allocated at 0x3fff573c (with safety padding)
I (36534) LED_CTRL: LED pattern -> 1
I (36538) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36542) STATE_MGR: âœ… Voice mode transition complete
I (36558) STT: â•‘ ğŸ¤ STARTING AUDIO CAPTURE
I (36564) STATE_MGR: âœ… Entered VOICE_ACTIVE state
I (36569) STT: â•‘ Chunk size: 1024 bytes | Timeout: 100 ms
I (36581) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36585) STATE_MGR: STT pipeline reported start
I (36613) STATE_MGR: TTS playback start event received
I (40680) STATE_MGR: Button event received: 1 in state VOICE_ACTIVE
I (40680) BUTTON: Single click confirmed
W (40680) STATE_MGR: Guardrail soft override: stopping voice pipeline while busy
I (40689) STATE_MGR: Single click - mode toggle requested
I (40695) STATE_MGR: Switching: Voice â†’ Camera (count: 4)
I (40751) STATE_MGR: === TRANSITION TO CAMERA MODE ===
I (40751) STATE_MGR: Stopping voice mode components...
I (40752) STT: Stopping STT pipeline...
I (40798) STT: Capture stopped and ring buffer drained; ending streaming loop
I (40799) STT: Sending EOS signal...
I (40800) WEBSOCKET: Sending EOS signal
I (40806) STT: Audio capture task stopped (captured 139264 bytes total)
I (40809) STT: Audio streaming session complete (streamed 138240 bytes in 34 chunks)
I (40831) STT: STT pipeline stopped
I (40831) STATE_MGR: Voice pipeline reported COMPLETE
I (40832) STATE_MGR: Waiting for TTS playback drain (~0 bytes pending, timeout 5000 ms)
I (40941) STATE_MGR: TTS drain complete - pipeline finished
I (40941) TTS: â¹ï¸ Stopping TTS decoder...
I (40956) TTS: EOS requested and stream buffer is empty. Exiting playback task.
I (40956) TTS: ğŸµ TTS playback task exiting (played 0 bytes, result: ESP_OK)
I (40961) TTS:   âœ“ DMA buffer freed from PSRAM
I (40972) TTS: â¹ï¸ TTS decoder stopped (played 0 bytes)
I (41049) WEBSOCKET: Received text message: {"status": "processing", "stage": "transcription"}
I (41050) WEBSOCKET: Server status: processing
I (41053) WEBSOCKET: Server stage: transcription
I (41058) WEBSOCKET: Pipeline stage changed: complete -> transcription
I (41073) STATE_MGR: Acquiring I2S mutex...
I (41073) STATE_MGR: Deinitializing audio drivers...
I (41076) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (41094) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (41101) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (41119) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (41126) AUDIO: âœ… RX channel disabled (took 0 ms)
I (41132) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (41138) AUDIO: âœ… TX channel disabled (took 0 ms)
I (41144) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (41200) AUDIO: [STEP 4/5] Deleting RX channel...
I (41201) AUDIO: âœ… RX channel deleted (took 0 ms)
I (41201) AUDIO: [STEP 5/5] Deleting TX channel...
I (41206) AUDIO: âœ… TX channel deleted (took 0 ms)
I (41211) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (41269) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (41276) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (41283) AUDIO: â•‘ Camera Can Now Initialize
I (41288) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (41306) STATE_MGR: Initializing camera...
I (41310) CAMERA: Initializing camera...
I (41315) gpio: GPIO[25]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:2
E (41325) gpio: gpio_install_isr_service(503): GPIO isr service already installed
I (41333) cam_hal: cam init ok
W (41337) ledc: GPIO 0 is not usable, maybe conflict with others
I (41343) sccb-ng: pin_sda 26 pin_scl 27
I (41348) sccb-ng: sccb_i2c_port=1
I (41353) gpio: GPIO[32]| InputEn: 0| OutputEn: 1| OpenDrain: 0| Pullup: 0| Pulldown: 0| Intr:0
I (41395) camera: Camera PID=0x26 VER=0x42 MIDL=0x7f MIDH=0xa2
I (41395) camera: Detected OV2640 camera
I (41395) camera: Detected camera at address=0x30
I (41476) cam_hal: PSRAM DMA mode disabled
I (41476) cam_hal: buffer_size: 32768, half_buffer_size: 4096, node_buffer_size: 2048, node_cnt: 16, total_cnt: 15
I (41481) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (41488) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (41494) cam_hal: cam config ok
I (41498) ov2640: Set PLL: clk_2x: 0, clk_div: 0, pclk_auto: 0, pclk_div: 8
I (41580) CAMERA: Camera initialized successfully
I (41580) STATE_MGR: I2S mutex released
I (41580) STATE_MGR: âœ… Camera mode transition complete
I (41585) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (41603) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (41610) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (41628) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (41637) WEBSOCKET: Received text message: {"status": "processing", "stage": "llm", "transcript": "how can you help me"}
I (41646) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (41658) WEBSOCKET: Server status: processing
I (41670) WEBSOCKET: Server stage: llm
I (41665) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (41674) WEBSOCKET: Pipeline stage changed: transcription -> llm
I (41692) AUDIO: [DIAG] Pre-init state:
I (41704) AUDIO:   Free heap: 3982352 bytes
I (41708) AUDIO:   Free internal RAM: 66599 bytes
I (41714) AUDIO:   Free DMA-capable: 46327 bytes
I (41719) AUDIO:   Free PSRAM: 3936032 bytes
I (41724) AUDIO:   Timestamp: 40199 ms
I (41729) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (41735) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (41743) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (41752) AUDIO:   DMA frame num (per desc): 1020
I (41757) AUDIO:   DMA total samples (effective): 4080
I (41763) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (41770) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (41776) AUDIO: âœ… I2S channels created (took 0 ms)
I (41782) AUDIO:   TX handle: 0x3ffcb5ec | RX handle: 0x3ffca8f4
I (41788) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (41795) AUDIO:   Sample rate: 16000 Hz
I (41800) AUDIO:   MCLK: DISABLED
I (41804) AUDIO:   BCLK: GPIO14 (shared)
I (41808) AUDIO:   WS:   GPIO15 (shared)
I (41813) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (41820) AUDIO: âœ… TX channel configured (took 1 ms)
I (41824) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (41831) AUDIO:   Sample rate: 16000 Hz
I (41836) AUDIO:   MCLK: DISABLED
I (41840) AUDIO:   BCLK: GPIO14 (shared)
I (41843) WEBSOCKET: Received text message: {"status": "processing", "stage": "tts", "response": "I can answer questions, provide information, and help with tasks like setting reminders and sending messages."}
I (41844) AUDIO:   WS:   GPIO15 (shared)
I (41864) WEBSOCKET: Server status: processing
I (41868) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (41873) WEBSOCKET: Server stage: tts
I (41879) AUDIO: âœ… RX channel configured (took 0 ms)
I (41889) AUDIO: [STEP 4/6] Enabling TX channel...
I (41883) WEBSOCKET: Pipeline stage changed: llm -> tts
I (41895) AUDIO: âœ… TX channel enabled (took 0 ms)
I (41906) AUDIO: [STEP 5/6] Enabling RX channel...
I (41911) AUDIO: âœ… RX channel enabled (took 0 ms)
I (41917) AUDIO: [STEP 6/6] Hardware stabilization...
I (41923) AUDIO:   Phase 1: Initial settle (50ms)
I (41978) AUDIO:   Phase 2: DMA verification
I (41978) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (41979) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (42057) WEBSOCKET: Received binary audio data: 4096 bytes
I (42061) WEBSOCKET: Received binary audio data: 1124 bytes
I (42069) WEBSOCKET: Received binary audio data: 2972 bytes
I (42074) WEBSOCKET: Received binary audio data: 1344 bytes
I (42082) WEBSOCKET: Received binary audio data: 2752 bytes
I (42089) WEBSOCKET: Received binary audio data: 4096 bytes
I (42094) WEBSOCKET: Received binary audio data: 344 bytes
I (42100) WEBSOCKET: Received binary audio data: 3752 bytes
I (42105) WEBSOCKET: Received binary audio data: 564 bytes
I (42110) WEBSOCKET: Received binary audio data: 1440 bytes
I (42113) WEBSOCKET: Received binary audio data: 2092 bytes
I (42122) WEBSOCKET: Received binary audio data: 4096 bytes
I (42128) WEBSOCKET: Received binary audio data: 1004 bytes
I (42131) WEBSOCKET: Received binary audio data: 3092 bytes
I (42136) AUDIO: [DIAG] Post-init state:
I (42140) AUDIO:   Free heap: 3949420 bytes
I (42145) AUDIO:   Free internal RAM: 37047 bytes
I (42150) AUDIO:   Free DMA-capable: 13319 bytes
I (42146) WEBSOCKET: Received binary audio data: 4096 bytes
I (42155) AUDIO:   Free PSRAM: 3936168 bytes
I (42167) AUDIO:   Timestamp: 40641 ms
I (42169) WEBSOCKET: Received binary audio data: 4096 bytes
I (42171) AUDIO:   Total init time: 201 ms
I (42182) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (42184) WEBSOCKET: Received binary audio data: 4096 bytes
I (42200) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (42212) WEBSOCKET: Received binary audio data: 4096 bytes
I (42212) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (42223) WEBSOCKET: Received binary audio data: 664 bytes
I (42224) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (42239) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (42246) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (42252) WEBSOCKET: Received binary audio data: 3432 bytes
I (42264) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (42276) WEBSOCKET: Received binary audio data: 4096 bytes
I (42288) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (42300) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (42307) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (42301) WEBSOCKET: Received binary audio data: 4096 bytes
I (42314) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (42326) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (42326) WEBSOCKET: Received binary audio data: 4096 bytes
I (42357) WEBSOCKET: Received binary audio data: 1544 bytes
I (42361) WEBSOCKET: Received binary audio data: 2552 bytes
I (42368) WEBSOCKET: Received binary audio data: 324 bytes
I (42372) WEBSOCKET: Received binary audio data: 2880 bytes
I (42377) WEBSOCKET: Received binary audio data: 892 bytes
I (42387) WEBSOCKET: Received binary audio data: 4096 bytes
I (42392) WEBSOCKET: Received binary audio data: 764 bytes
I (42397) WEBSOCKET: Received binary audio data: 1440 bytes
I (42402) WEBSOCKET: Received binary audio data: 1892 bytes
I (42412) WEBSOCKET: Received binary audio data: 4096 bytes
I (42418) WEBSOCKET: Received binary audio data: 1204 bytes
I (42421) WEBSOCKET: Received binary audio data: 2892 bytes
I (42429) WEBSOCKET: Received binary audio data: 1424 bytes
I (42433) WEBSOCKET: Received binary audio data: 2672 bytes
I (42443) WEBSOCKET: Received binary audio data: 4096 bytes
I (42448) WEBSOCKET: Received binary audio data: 424 bytes
I (42455) WEBSOCKET: Received binary audio data: 3672 bytes
I (42460) WEBSOCKET: Received binary audio data: 644 bytes
I (42465) WEBSOCKET: Received binary audio data: 2880 bytes
I (42470) WEBSOCKET: Received binary audio data: 572 bytes
I (42480) WEBSOCKET: Received binary audio data: 4096 bytes
W (42481) TTS: Stream buffer nearly full - dropping 4096 bytes (available: 1335, drops: 25)
I (42495) WEBSOCKET: Received binary audio data: 4096 bytes
I (42501) WEBSOCKET: Received binary audio data: 1304 bytes
I (42505) WEBSOCKET: Received binary audio data: 2792 bytes
I (42515) WEBSOCKET: Received binary audio data: 4096 bytes
I (42519) WEBSOCKET: Received binary audio data: 304 bytes
I (42523) WEBSOCKET: Received binary audio data: 3792 bytes
I (42534) WEBSOCKET: Received binary audio data: 4096 bytes
I (42538) WEBSOCKET: Received binary audio data: 744 bytes
I (42542) WEBSOCKET: Received binary audio data: 3352 bytes
I (42551) WEBSOCKET: Received binary audio data: 4096 bytes
I (42557) WEBSOCKET: Received binary audio data: 1184 bytes
I (42562) WEBSOCKET: Received binary audio data: 2912 bytes
I (42571) WEBSOCKET: Received binary audio data: 4096 bytes
I (42577) WEBSOCKET: Received binary audio data: 1624 bytes
I (42579) WEBSOCKET: Received binary audio data: 2472 bytes
I (42589) WEBSOCKET: Received binary audio data: 4096 bytes
I (42595) WEBSOCKET: Received binary audio data: 4096 bytes
I (42601) WEBSOCKET: Received binary audio data: 844 bytes
I (42605) WEBSOCKET: Received binary audio data: 3252 bytes
I (42614) WEBSOCKET: Received binary audio data: 4096 bytes
I (42619) WEBSOCKET: Received binary audio data: 1284 bytes
I (42627) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (42639) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (42647) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (42655) WEBSOCKET: Received binary audio data: 2812 bytes
I (42665) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (42677) WEBSOCKET: Received binary audio data: 4096 bytes
I (42678) AUDIO: âœ… RX channel disabled (took 0 ms)
I (42689) WEBSOCKET: Received binary audio data: 4096 bytes
I (42690) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (42703) AUDIO: âœ… TX channel disabled (took 0 ms)
I (42703) WEBSOCKET: Received binary audio data: 4096 bytes
I (42708) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (42719) WEBSOCKET: Received binary audio data: 4096 bytes
W (42727) TTS: Stream buffer nearly full - dropping 4096 bytes (available: 1031, drops: 50)
I (42741) WEBSOCKET: Received binary audio data: 4096 bytes
I (42746) WEBSOCKET: Received binary audio data: 1164 bytes
I (42751) WEBSOCKET: Received binary audio data: 2932 bytes
I (42758) WEBSOCKET: Received binary audio data: 1384 bytes
I (42763) WEBSOCKET: Received binary audio data: 2712 bytes
I (42771) AUDIO: [STEP 4/5] Deleting RX channel...
I (42772) WEBSOCKET: Received binary audio data: 1604 bytes
I (42774) AUDIO: âœ… RX channel deleted (took 0 ms)
I (42782) WEBSOCKET: Received binary audio data: 2492 bytes
I (42785) AUDIO: [STEP 5/5] Deleting TX channel...
I (42797) AUDIO: âœ… TX channel deleted (took 0 ms)
I (42798) WEBSOCKET: Received binary audio data: 4096 bytes
I (42802) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (42813) WEBSOCKET: Received binary audio data: 4096 bytes
I (42826) WEBSOCKET: Received binary audio data: 4096 bytes
I (42832) WEBSOCKET: Received binary audio data: 1044 bytes
I (42837) WEBSOCKET: Received binary audio data: 3052 bytes
I (42845) WEBSOCKET: Received binary audio data: 1264 bytes
I (42849) WEBSOCKET: Received binary audio data: 2832 bytes
I (42859) WEBSOCKET: Received binary audio data: 4096 bytes
I (42864) WEBSOCKET: Received binary audio data: 264 bytes
I (42866) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (42875) WEBSOCKET: Received binary audio data: 3832 bytes
I (42884) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (42895) WEBSOCKET: Received binary audio data: 4096 bytes
I (42897) AUDIO: â•‘ Camera Can Now Initialize
I (42908) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (42908) WEBSOCKET: Received binary audio data: 4096 bytes
I (42926) LED_CTRL: LED pattern -> 3
I (42936) STATE_MGR: âœ… Entered CAMERA_STANDBY state
I (42937) WEBSOCKET: Received binary audio data: 2940 bytes
I (42951) WEBSOCKET: Received text message: {"status": "complete"}
I (42952) STATE_MGR: STT pipeline reported stop
I (42956) WEBSOCKET: Server status: complete
I (42965) WEBSOCKET: Pipeline stage changed: tts -> complete
I (42971) STATE_MGR: Pipeline stage event: transcription
I (42988) STATE_MGR: Pipeline stage event: llm
I (42998) STATE_MGR: Pipeline stage event: tts
I (43008) STATE_MGR: Pipeline stage event: complete
I (108426) BUTTON: Single click confirmed
I (108426) STATE_MGR: Button event received: 1 in state CAMERA_STANDBY
I (108427) STATE_MGR: Single click - mode toggle requested
I (108433) STATE_MGR: Switching: Camera â†’ Voice (count: 5)
I (108489) STATE_MGR: === TRANSITION TO VOICE MODE ===
I (108489) STATE_MGR: Stopping camera...
I (108489) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108505) STATE_MGR: â•‘ STEP 2: Acquiring I2S configuration mutex
I (108512) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108528) STATE_MGR:   Timeout: 5000 ms
I (108533) STATE_MGR:   Timestamp: 107007 ms
I (108538) STATE_MGR:   âœ“ Mutex acquired (took 0 ms)
I (108544) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108560) STATE_MGR: â•‘ STEP 3: Deinitializing camera hardware
I (108567) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108583) STATE_MGR:   Free heap before: 3982352 bytes
I (108589) STATE_MGR:   Free PSRAM before: 3936032 bytes
I (108595) CAMERA: Deinitializing camera...
I (108601) CAMERA: Camera deinitialized
I (108604) STATE_MGR:   âœ“ Camera deinitialized (took 9 ms)
I (108610) STATE_MGR:   Free heap after: 4144768 bytes
I (108616) STATE_MGR:   Free PSRAM after: 4060348 bytes
I (108622) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108639) STATE_MGR: â•‘ HARDWARE STABILIZATION - CRITICAL
I (108645) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108661) STATE_MGR:   Phase 1: Initial settle (100ms) - Free camera interrupts
I (108769) STATE_MGR:   Phase 2: GPIO matrix settle (100ms) - Reconfigure pins
I (108869) STATE_MGR:   Phase 3: Final settle (50ms) - Stabilize state
I (108919) STATE_MGR:   âœ“ Total stabilization: 250ms
I (108919) STATE_MGR:   Timestamp: 107394 ms
I (108919) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108935) STATE_MGR: â•‘ STEP 4: Initializing I2S audio drivers
I (108942) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108958) STATE_MGR:   Free heap before: 4144768 bytes
I (108964) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (108982) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (108989) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109008) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109026) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (109033) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109051) AUDIO: [DIAG] Pre-init state:
I (109056) AUDIO:   Free heap: 4141648 bytes
I (109061) AUDIO:   Free internal RAM: 101579 bytes
I (109066) AUDIO:   Free DMA-capable: 81307 bytes
I (109071) AUDIO:   Free PSRAM: 4060348 bytes
I (109077) AUDIO:   Timestamp: 107551 ms
I (109081) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (109088) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (109096) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (109104) AUDIO:   DMA frame num (per desc): 1020
I (109110) AUDIO:   DMA total samples (effective): 4080
I (109116) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (109123) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (109130) AUDIO: âœ… I2S channels created (took 0 ms)
I (109135) AUDIO:   TX handle: 0x3ffafcc8 | RX handle: 0x3ffcb4c0
I (109142) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (109148) AUDIO:   Sample rate: 16000 Hz
I (109153) AUDIO:   MCLK: DISABLED
I (109157) AUDIO:   BCLK: GPIO14 (shared)
I (109162) AUDIO:   WS:   GPIO15 (shared)
I (109167) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (109173) AUDIO: âœ… TX channel configured (took 1 ms)
I (109178) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (109185) AUDIO:   Sample rate: 16000 Hz
I (109190) AUDIO:   MCLK: DISABLED
I (109194) AUDIO:   BCLK: GPIO14 (shared)
I (109198) AUDIO:   WS:   GPIO15 (shared)
I (109203) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (109209) AUDIO: âœ… RX channel configured (took 0 ms)
I (109215) AUDIO: [STEP 4/6] Enabling TX channel...
I (109220) AUDIO: âœ… TX channel enabled (took 0 ms)
I (109226) AUDIO: [STEP 5/6] Enabling RX channel...
I (109232) AUDIO: âœ… RX channel enabled (took 0 ms)
I (109237) AUDIO: [STEP 6/6] Hardware stabilization...
I (109243) AUDIO:   Phase 1: Initial settle (50ms)
I (109298) AUDIO:   Phase 2: DMA verification
I (109298) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (109299) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (109456) AUDIO: [DIAG] Post-init state:
I (109456) AUDIO:   Free heap: 4118788 bytes
I (109457) AUDIO:   Free internal RAM: 78719 bytes
I (109460) AUDIO:   Free DMA-capable: 58447 bytes
I (109466) AUDIO:   Free PSRAM: 4060348 bytes
I (109471) AUDIO:   Timestamp: 107945 ms
I (109475) AUDIO:   Total init time: 201 ms
I (109480) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109498) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (109504) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (109510) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (109519) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (109526) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109544) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109562) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (109568) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (109575) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (109582) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (109588) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109606) STATE_MGR:   âœ“ Audio initialized (took 641 ms)
I (109612) STATE_MGR:   Free heap after: 4118788 bytes
I (109618) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109634) STATE_MGR: â•‘ STEP 5: I2S mutex released
I (109640) STATE_MGR: â•‘ Total transition time: 900 ms
I (109646) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109662) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109679) STATE_MGR: â•‘ STEP 6: Starting STT/TTS pipelines
I (109685) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (109701) STT: Starting STT pipeline...
I (109706) STT: [CORE AFFINITY] Creating audio capture task on Core 0 (co-located with Wi-Fi)
I (109715) STT: âœ… STT pipeline started
I (109715) STT: [STABILIZATION] Phase 1: Waiting 200ms for I2S DMA...
I (109727) STT:   Current time: 108201 ms
I (109715) STT: Audio streaming session activated
I (109737) STT: Starting audio streaming to server...
I (109731) STT:   Free heap: 4110236 bytes
I (109770) TTS: ğŸµ Starting TTS decoder...
I (109770) TTS: Initializing TTS decoder...
W (109771) TTS: TTS decoder already initialized
I (109774) TTS: [CORE AFFINITY] Creating TTS playback task on Core 1 (APP_CPU) with safety measures
I (109784) TTS: âœ… TTS decoder started successfully
I (109825) TTS: ğŸµ TTS playback task started on Core 1
I (109825) TTS:   âœ“ DMA buffer allocated in PSRAM at 0x3f820b48 (4096 bytes)
I (109831) TTS: âœ… WAV header parsed successfully
I (109833) TTS: === WAV File Info ===
I (109838) TTS: Sample Rate: 16000 Hz
I (109842) TTS: Channels: 1
I (109845) TTS: Bits per Sample: 16
I (109850) TTS: Audio Format: 1 (PCM)
I (109854) TTS: Declared Data Size: 244560 bytes
I (109859) TTS: Block Align: 2
I (109863) TTS: Byte Rate: 32000
I (109867) TTS: ====================
I (109871) TTS: ğŸ”” Playback start feedback dispatched (bytes_received=0)
I (109947) STT: [STABILIZATION] Phase 2: Verify audio driver state...
I (109947) STT:   âœ“ Audio driver initialized
I (109948) STT: [STABILIZATION] Phase 3: Additional 100ms settle...
I (110055) STT:   Total stabilization: 300ms
I (110055) STT:   Timestamp: 108530 ms
I (110055) STT: [BUFFER] Allocating 1024 byte capture buffer...
I (110060) STT:   âœ“ DMA-capable buffer allocated at 0x3fff573c (with safety padding)
I (110065) LED_CTRL: LED pattern -> 1
I (110069) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (110073) STATE_MGR: âœ… Voice mode transition complete
I (110089) STT: â•‘ ğŸ¤ STARTING AUDIO CAPTURE
I (110095) STATE_MGR: âœ… Entered VOICE_ACTIVE state
I (110100) STT: â•‘ Chunk size: 1024 bytes | Timeout: 100 ms
I (110112) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (110116) STATE_MGR: STT pipeline reported start
I (110144) STATE_MGR: TTS playback start event received
I (117519) STT: [CAPTURE] âœ… Alive... 500 reads completed (Free Heap: 4093372 bytes)
I (122388) STATE_MGR: Button event received: 1 in state VOICE_ACTIVE
I (122388) BUTTON: Single click confirmed
W (122388) STATE_MGR: Guardrail soft override: stopping voice pipeline while busy
I (122397) STATE_MGR: Single click - mode toggle requested
I (122403) STATE_MGR: Switching: Voice â†’ Camera (count: 6)
I (122459) STATE_MGR: === TRANSITION TO CAMERA MODE ===
I (122459) STATE_MGR: Stopping voice mode components...
I (122460) STT: Stopping STT pipeline...
I (122492) STT: Audio capture task stopped (captured 386048 bytes total)
I (122493) STT: Streaming task received stop signal
I (122494) STT: Sending EOS signal...
I (122498) WEBSOCKET: Sending EOS signal
I (122505) STT: Audio streaming session complete (streamed 385024 bytes in 94 chunks)
I (122512) STT: STT pipeline stopped
I (122516) STATE_MGR: Voice pipeline reported COMPLETE
I (122522) STATE_MGR: Waiting for TTS playback drain (~0 bytes pending, timeout 5000 ms)
I (122548) WEBSOCKET: Received text message: {"status": "processing", "stage": "transcription"}
I (122548) WEBSOCKET: Server status: processing
I (122551) WEBSOCKET: Server stage: transcription
I (122557) WEBSOCKET: Pipeline stage changed: complete -> transcription
I (123156) WEBSOCKET: Received text message: {"status": "error", "message": "Could not understand audio. Please try again."}
I (123158) WEBSOCKET: Server status: error
W (127530) STATE_MGR: TTS playback drain timed out; proceeding with shutdown
I (127531) TTS: â¹ï¸ Stopping TTS decoder...
I (127532) TTS: EOS requested and stream buffer is empty. Exiting playback task.
I (127540) TTS: ğŸµ TTS playback task exiting (played 64460 bytes, result: ESP_OK)
I (127549) TTS:   âœ“ DMA buffer freed from PSRAM
I (127562) TTS: â¹ï¸ TTS decoder stopped (played 64460 bytes)
I (127662) STATE_MGR: Acquiring I2S mutex...
I (127662) STATE_MGR: Deinitializing audio drivers...
I (127662) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (127680) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (127688) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (127706) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (127713) AUDIO: âœ… RX channel disabled (took 0 ms)
I (127718) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (127725) AUDIO: âœ… TX channel disabled (took 0 ms)
I (127731) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (127787) AUDIO: [STEP 4/5] Deleting RX channel...
I (127788) AUDIO: âœ… RX channel deleted (took 0 ms)
I (127788) AUDIO: [STEP 5/5] Deleting TX channel...
I (127793) AUDIO: âœ… TX channel deleted (took 0 ms)
I (127799) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (127856) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (127863) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (127870) AUDIO: â•‘ Camera Can Now Initialize
I (127875) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (127893) STATE_MGR: Initializing camera...
I (127898) CAMERA: Initializing camera...
I (127903) gpio: GPIO[25]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:2
E (127912) gpio: gpio_install_isr_service(503): GPIO isr service already installed
I (127921) cam_hal: cam init ok
W (127925) ledc: GPIO 0 is not usable, maybe conflict with others
I (127931) sccb-ng: pin_sda 26 pin_scl 27
I (127936) sccb-ng: sccb_i2c_port=1
I (127941) gpio: GPIO[32]| InputEn: 0| OutputEn: 1| OpenDrain: 0| Pullup: 0| Pulldown: 0| Intr:0
I (127983) camera: Camera PID=0x26 VER=0x42 MIDL=0x7f MIDH=0xa2
I (127983) camera: Detected OV2640 camera
I (127983) camera: Detected camera at address=0x30
I (128064) cam_hal: PSRAM DMA mode disabled
I (128064) cam_hal: buffer_size: 32768, half_buffer_size: 4096, node_buffer_size: 2048, node_cnt: 16, total_cnt: 15
I (128069) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (128076) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (128083) cam_hal: cam config ok
I (128086) ov2640: Set PLL: clk_2x: 0, clk_div: 0, pclk_auto: 0, pclk_div: 8
I (128169) CAMERA: Camera initialized successfully
I (128169) STATE_MGR: I2S mutex released
I (128169) STATE_MGR: âœ… Camera mode transition complete
I (128174) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (128192) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (128200) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (128218) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (128236) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (128243) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (128261) AUDIO: [DIAG] Pre-init state:
I (128266) AUDIO:   Free heap: 3982380 bytes
I (128271) AUDIO:   Free internal RAM: 66627 bytes
I (128276) AUDIO:   Free DMA-capable: 46355 bytes
I (128281) AUDIO:   Free PSRAM: 3936032 bytes
I (128286) AUDIO:   Timestamp: 126761 ms
I (128291) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (128298) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (128306) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (128314) AUDIO:   DMA frame num (per desc): 1020
I (128320) AUDIO:   DMA total samples (effective): 4080
I (128326) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (128333) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (128339) AUDIO: âœ… I2S channels created (took 0 ms)
I (128345) AUDIO:   TX handle: 0x3ffcb5ec | RX handle: 0x3ffca894
I (128352) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (128358) AUDIO:   Sample rate: 16000 Hz
I (128363) AUDIO:   MCLK: DISABLED
I (128367) AUDIO:   BCLK: GPIO14 (shared)
I (128372) AUDIO:   WS:   GPIO15 (shared)
I (128376) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (128383) AUDIO: âœ… TX channel configured (took 1 ms)
I (128388) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (128395) AUDIO:   Sample rate: 16000 Hz
I (128400) AUDIO:   MCLK: DISABLED
I (128404) AUDIO:   BCLK: GPIO14 (shared)
I (128408) AUDIO:   WS:   GPIO15 (shared)
I (128413) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (128419) AUDIO: âœ… RX channel configured (took 0 ms)
I (128425) AUDIO: [STEP 4/6] Enabling TX channel...
I (128430) AUDIO: âœ… TX channel enabled (took 0 ms)
I (128436) AUDIO: [STEP 5/6] Enabling RX channel...
I (128442) AUDIO: âœ… RX channel enabled (took 0 ms)
I (128447) AUDIO: [STEP 6/6] Hardware stabilization...
I (128453) AUDIO:   Phase 1: Initial settle (50ms)
I (128483) BUTTON: Single click confirmed
I (128508) AUDIO:   Phase 2: DMA verification
I (128508) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (128509) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (128666) AUDIO: [DIAG] Post-init state:
I (128666) AUDIO:   Free heap: 3956400 bytes
I (128666) AUDIO:   Free internal RAM: 40647 bytes
I (128670) AUDIO:   Free DMA-capable: 20391 bytes
I (128676) AUDIO:   Free PSRAM: 3936032 bytes
I (128681) AUDIO:   Timestamp: 127155 ms
I (128685) AUDIO:   Total init time: 201 ms
I (128690) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (128708) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (128714) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (128720) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (128729) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (128736) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (128754) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (128772) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (128778) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (128785) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (128792) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (128798) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129099) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129106) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (129114) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129132) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (129139) AUDIO: âœ… RX channel disabled (took 0 ms)
I (129145) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (129151) AUDIO: âœ… TX channel disabled (took 0 ms)
I (129157) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (129214) AUDIO: [STEP 4/5] Deleting RX channel...
I (129215) AUDIO: âœ… RX channel deleted (took 0 ms)
I (129215) AUDIO: [STEP 5/5] Deleting TX channel...
I (129220) AUDIO: âœ… TX channel deleted (took 0 ms)
I (129226) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (129283) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129290) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (129297) AUDIO: â•‘ Camera Can Now Initialize
I (129302) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129320) LED_CTRL: LED pattern -> 3
I (129324) STATE_MGR: âœ… Entered CAMERA_STANDBY state
I (129340) STATE_MGR: STT pipeline reported stop
I (129350) STATE_MGR: Pipeline stage event: transcription
I (129360) STATE_MGR: Button event received: 1 in state CAMERA_STANDBY
W (129361) STATE_MGR: Guardrail blocked request: audio pipeline busy
I (129364) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129382) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (129389) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129407) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129425) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (129432) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129450) AUDIO: [DIAG] Pre-init state:
I (129455) AUDIO:   Free heap: 3979252 bytes
I (129460) AUDIO:   Free internal RAM: 63499 bytes
I (129465) AUDIO:   Free DMA-capable: 43227 bytes
I (129471) AUDIO:   Free PSRAM: 3936032 bytes
I (129476) AUDIO:   Timestamp: 127950 ms
I (129480) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (129487) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (129495) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (129504) AUDIO:   DMA frame num (per desc): 1020
I (129509) AUDIO:   DMA total samples (effective): 4080
I (129515) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (129522) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (129529) AUDIO: âœ… I2S channels created (took 0 ms)
I (129534) AUDIO:   TX handle: 0x3ffcb5ec | RX handle: 0x3ffca8f4
I (129541) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (129548) AUDIO:   Sample rate: 16000 Hz
I (129552) AUDIO:   MCLK: DISABLED
I (129556) AUDIO:   BCLK: GPIO14 (shared)
I (129561) AUDIO:   WS:   GPIO15 (shared)
I (129566) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (129573) AUDIO: âœ… TX channel configured (took 1 ms)
I (129577) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (129584) AUDIO:   Sample rate: 16000 Hz
I (129589) AUDIO:   MCLK: DISABLED
I (129593) AUDIO:   BCLK: GPIO14 (shared)
I (129598) AUDIO:   WS:   GPIO15 (shared)
I (129602) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (129609) AUDIO: âœ… RX channel configured (took 0 ms)
I (129614) AUDIO: [STEP 4/6] Enabling TX channel...
I (129620) AUDIO: âœ… TX channel enabled (took 0 ms)
I (129625) AUDIO: [STEP 5/6] Enabling RX channel...
I (129631) AUDIO: âœ… RX channel enabled (took 0 ms)
I (129636) AUDIO: [STEP 6/6] Hardware stabilization...
I (129642) AUDIO:   Phase 1: Initial settle (50ms)
I (129698) AUDIO:   Phase 2: DMA verification
I (129698) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (129699) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (129856) AUDIO: [DIAG] Post-init state:
I (129856) AUDIO:   Free heap: 3956392 bytes
I (129857) AUDIO:   Free internal RAM: 40639 bytes
I (129860) AUDIO:   Free DMA-capable: 20367 bytes
I (129866) AUDIO:   Free PSRAM: 3936032 bytes
I (129871) AUDIO:   Timestamp: 128345 ms
I (129875) AUDIO:   Total init time: 201 ms
I (129880) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129898) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (129904) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (129910) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (129919) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (129926) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129944) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (129962) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (129968) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (129975) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (129982) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (129988) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (131374) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (131381) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (131389) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (131407) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (131414) AUDIO: âœ… RX channel disabled (took 0 ms)
I (131420) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (131426) AUDIO: âœ… TX channel disabled (took 0 ms)
I (131432) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (131489) AUDIO: [STEP 4/5] Deleting RX channel...
I (131490) AUDIO: âœ… RX channel deleted (took 0 ms)
I (131490) AUDIO: [STEP 5/5] Deleting TX channel...
I (131495) AUDIO: âœ… TX channel deleted (took 0 ms)
I (131501) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (131558) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (131565) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (131572) AUDIO: â•‘ Camera Can Now Initialize
I (131577) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                                                                                                                                                                                                                                                                                                                                                                    