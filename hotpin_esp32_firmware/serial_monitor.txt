PS F:\Documents\College\6th Semester\Project\ESP_Warp\hotpin_esp32_firmware> idf.py monitor
Executing action: monitor
Serial port COM7
Connecting.....
Detecting chip type... Unsupported detection protocol, switching and trying again...
Connecting...
Detecting chip type... ESP32
Running idf_monitor in directory 'F:\Documents\College\6th Semester\Project\ESP_Warp\hotpin_esp32_firmware'
Executing "C:\Espressif\python_env\idf5.4_py3.11_env\Scripts\python.exe C:\Espressif\frameworks\esp-idf-v5.4.2\tools/idf_monitor.py -p COM7 -b 115200 --toolchain-prefix xtensa-esp32-elf- --target esp32 --revision 0 'F:\Documents\College\6th Semester\Project\ESP_Warp\hotpin_esp32_firmware\build\hotpin_esp32_firmware.elf' --force-color -m 'C:\Espressif\python_env\idf5.4_py3.11_env\Scripts\python.exe' 'C:\Espressif\frameworks\esp-idf-v5.4.2\tools\idf.py'"...
--- Warning: GDB cannot open serial ports accessed as COMx
--- Using \\.\COM7 instead...
--- esp-idf-monitor 1.7.0 on \\.\COM7 115200
--- Quit: Ctrl+] | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H
I (538) boot: Loaded app from partition at offset 0x10000
I (538) boot: Disabling RNG early entropy source...
I (548) quad_psram: This chip is ESP32-D0WD
I (549) esp_psram: Found 4MB PSRAM device
I (549) esp_psram: Speed: 40MHz
I (552) esp_psram: PSRAM initialized, cache is in low/high (2-core) mode.
I (560) cpu_start: Multicore app
ets Jul 29 2019 12:21:46

rst:0x1 (POWERON_RESET),boot:0x13 (SPI_FAST_FLASH_BOOT)
configsip: 0, SPIWP:0xee
clk_drv:0x00,q_drv:0x00,d_drv:0x00,cs0_drv:0x00,hd_drv:0x00,wp_drv:0x00
mode:DIO, clock div:2
load:0x3fff0030,len:6276
load:0x40078000,len:15736
load:0x40080400,len:4
load:0x40080404,len:3860
entry 0x4008063c
I (29) boot: ESP-IDF v5.4.2-dirty 2nd stage bootloader
I (29) boot: compile time Oct 12 2025 11:45:22
I (30) boot: Multicore bootloader
I (31) boot: chip revision: v3.1
I (34) boot.esp32: SPI Speed      : 40MHz
I (38) boot.esp32: SPI Mode       : DIO
I (41) boot.esp32: SPI Flash Size : 2MB
I (45) boot: Enabling RNG early entropy source...
I (49) boot: Partition Table:
I (52) boot: ## Label            Usage          Type ST Offset   Length
I (58) boot:  0 nvs              WiFi data        01 02 00009000 00004000
I (65) boot:  1 otadata          OTA data         01 00 0000d000 00002000
I (71) boot:  2 phy_init         RF data          01 01 0000f000 00001000
I (78) boot:  3 factory          factory app      00 00 00010000 00180000
I (84) boot:  4 storage          Unknown data     01 81 00190000 00070000
I (91) boot: End of partition table
I (94) boot: Defaulting to factory image
I (98) esp_image: segment 0: paddr=00010020 vaddr=3f400020 size=37664h (226916) map
I (183) esp_image: segment 1: paddr=0004768c vaddr=3ff80000 size=0001ch (    28) load
I (183) esp_image: segment 2: paddr=000476b0 vaddr=3ffb0000 size=08968h ( 35176) load
I (200) esp_image: segment 3: paddr=00050020 vaddr=400d0020 size=bcc64h (773220) map
I (464) esp_image: segment 4: paddr=0010cc8c vaddr=3ffb8968 size=0935ch ( 37724) load
I (478) esp_image: segment 5: paddr=00115ff0 vaddr=40080000 size=1b394h (111508) load
I (538) boot: Loaded app from partition at offset 0x10000
I (538) boot: Disabling RNG early entropy source...
I (548) quad_psram: This chip is ESP32-D0WD
I (549) esp_psram: Found 4MB PSRAM device
I (549) esp_psram: Speed: 40MHz
I (552) esp_psram: PSRAM initialized, cache is in low/high (2-core) mode.
I (560) cpu_start: Multicore app
I (1454) esp_psram: SPI SRAM memory test OK
I (1462) cpu_start: Pro cpu start user code
I (1462) cpu_start: cpu freq: 240000000 Hz
I (1462) app_init: Application information:
I (1465) app_init: Project name:     hotpin_esp32_firmware
I (1471) app_init: App version:      a794485-dirty
I (1477) app_init: Compile time:     Oct 12 2025 11:45:00
I (1483) app_init: ELF file SHA256:  d96f9e5d9...
I (1488) app_init: ESP-IDF:          v5.4.2-dirty
I (1493) efuse_init: Min chip rev:     v0.0
I (1498) efuse_init: Max chip rev:     v3.99
I (1503) efuse_init: Chip rev:         v3.1
I (1509) heap_init: Initializing. RAM available for dynamic allocation:
I (1516) heap_init: At 3FFAE6E0 len 00001920 (6 KiB): DRAM
I (1522) heap_init: At 3FFC9320 len 00016CE0 (91 KiB): DRAM
I (1528) heap_init: At 3FFE0440 len 00003AE0 (14 KiB): D/IRAM
I (1534) heap_init: At 3FFE4350 len 0001BCB0 (111 KiB): D/IRAM
I (1541) heap_init: At 4009B394 len 00004C6C (19 KiB): IRAM
I (1547) esp_psram: Adding pool of 4096K of PSRAM memory to heap allocator
I (1555) spi_flash: detected chip: generic
I (1559) spi_flash: flash io: dio
W (1563) spi_flash: Detected size(4096k) larger than the size in the binary image header(2048k). Using the size in the binary image header.
I (1578) main_task: Started on CPU0
I (1581) esp_psram: Reserving pool of 32K of internal memory for DMA/internal allocations
I (1590) main_task: Calling app_main()
I (1594) HOTPIN_MAIN: ====================================
I (1600) HOTPIN_MAIN: HotPin ESP32-CAM AI Agent Starting
I (1606) HOTPIN_MAIN: ====================================
W (1612) HOTPIN_MAIN: Brownout detector disabled
I (1617) HOTPIN_MAIN: Validating PSRAM...
I (1622) HOTPIN_MAIN: PSRAM detected: 4194304 bytes (4.00 MB)
I (1629) HOTPIN_MAIN: PSRAM validation passed
I (1634) HOTPIN_MAIN: ====================================
I (1640) HOTPIN_MAIN: System Information:
I (1644) HOTPIN_MAIN: Chip: esp32
I (1648) HOTPIN_MAIN: Cores: 2
I (1652) HOTPIN_MAIN: Silicon revision: 301
I (1657) HOTPIN_MAIN: CPU Frequency: 240 MHz
I (1662) HOTPIN_MAIN: Flash: 2 MB external
I (1667) HOTPIN_MAIN: Free heap: 4365196 bytes
I (1672) HOTPIN_MAIN: PSRAM: 4194304 bytes
I (1677) HOTPIN_MAIN: ====================================
I (1683) HOTPIN_MAIN: Initializing NVS...
I (1712) HOTPIN_MAIN: NVS initialized successfully
I (1713) event_dispatcher: System event queue ready (16 entries)
I (1713) HOTPIN_MAIN: Synchronization primitives created
I (1719) HOTPIN_MAIN: Initializing WiFi...
I (1728) wifi:wifi driver task: 3ffd9f18, prio:23, stack:6656, core=0
I (1741) wifi:wifi firmware version: bea31f3
I (1742) wifi:wifi certification version: v7.0
I (1742) wifi:config NVS flash: enabled
I (1744) wifi:config nano formatting: disabled
I (1749) wifi:Init data frame dynamic rx buffer num: 32
I (1754) wifi:Init static rx mgmt buffer num: 5
I (1758) wifi:Init management short buffer num: 32
I (1762) wifi:Init dynamic tx buffer num: 32
I (1766) wifi:Init static rx buffer size: 1600
I (1771) wifi:Init static rx buffer num: 16
I (1774) wifi:Init dynamic rx buffer num: 32
I (1779) wifi_init: rx ba win: 6
I (1782) wifi_init: accept mbox: 6
I (1786) wifi_init: tcpip mbox: 32
I (1790) wifi_init: udp mbox: 6
I (1794) wifi_init: tcp mbox: 6
I (1798) wifi_init: tcp tx win: 5760
I (1802) wifi_init: tcp rx win: 5760
I (1806) wifi_init: tcp mss: 1440
I (1810) wifi_init: WiFi IRAM OP enabled
I (1815) wifi_init: WiFi RX IRAM OP enabled
I (1822) phy_init: phy_version 4860,6b7a6e5,Feb  6 2025,14:47:07
I (1891) wifi:mode : sta (80:f3:da:99:8c:64)
I (1892) wifi:enable tsf
I (1894) HOTPIN_MAIN: WiFi initialization complete, connecting to wifi...
I (1895) HOTPIN_MAIN: Waiting for WiFi connection...
I (1895) HOTPIN_MAIN: WiFi station started, connecting...
I (1922) wifi:new:<6,0>, old:<1,0>, ap:<255,255>, sta:<6,0>, prof:1, snd_ch_cfg:0x0
I (1923) wifi:state: init -> auth (0xb0)
I (1936) wifi:state: auth -> assoc (0x0)
I (1958) wifi:state: assoc -> run (0x10)
--- 0x40080400: _init at ??:?
I (1984) wifi:connected with wifi, aid = 31, channel 6, BW20, bssid = 2a:2f:0f:5c:80:a1
I (1985) wifi:security: WPA2-PSK, phy: bgn, rssi: -72
I (1988) wifi:pm start, type: 1

I (1989) wifi:dp: 1, bi: 102400, li: 3, scale listen interval from 307200 us to 307200 us
I (2000) HOTPIN_MAIN: WiFi connected to AP
I (2224) wifi:dp: 2, bi: 102400, li: 4, scale listen interval from 307200 us to 409600 us
I (2224) wifi:AP's beacon interval = 102400 us, DTIM period = 2
I (3055) esp_netif_handlers: sta ip: 172.24.158.214, mask: 255.255.255.0, gw: 172.24.158.191
I (3056) HOTPIN_MAIN: âœ… Got IP address: 172.24.158.214
I (3060) HOTPIN_MAIN: WiFi ready - WebSocket connection task will handle server connection
I (6909) HOTPIN_MAIN: Initializing button handler...
I (6909) BUTTON: Initializing button handler on GPIO 4
I (6910) gpio: GPIO[4]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:3
I (6919) BUTTON: Button FSM task started
W (6924) BUTTON: Button input low at init - waiting for release before enabling detection
I (6932) BUTTON: Button handler initialized successfully (initial level=0, primed=0)
I (6940) HOTPIN_MAIN: InitiI (6955) SERIAL_CMD: Serial command task started on Core 0

========================================
  HotPin Serial Command Interface
========================================
Commands:
  s - Toggle voice recording (start/stop)
  c - Capture image
  l - Long press (shutdown simulation)
  d - Toggle debug mode
  h - Show this help
========================================

âŒ Unknown command ' '. Press 'h' for help.
I (6982) SERIAL_CMD: âœ… Serial command interface initialized
I (6989) HOTPIN_MAIN: Initializing LED controller...
I (6994) LED_CTRL: Initializing LED controller on GPIO 33
I (7001) LED_CTRL: LED controller ready
I (7005) LED_CTRL: LED pattern -> 2
I (7009) HOTPIN_MAIN: Initializing WebSocket client...
I (7015) WEBSOCKET: Initializing WebSocket client...
I (7020) WEBSOCKET: Server URI: ws://172.24.158.58:8000/ws
I (7027) WEBSOCKET: Authorization header configured
I (7033) WEBSOCKET: âœ… WebSocket client initialized
I (7038) WEBSOCKET: Status callback registered
I (7043) HOTPIN_MAIN: WebSocket status callback registered
I (7049) HOTPIN_MAIN: Initializing HTTP client...
I (7054) HTTP_CLIENT: Initializing HTTP client
I (7060) HTTP_CLIENT: Authorization token configured
I (7065) HTTP_CLIENT: HTTP client initialized (server: http://172.24.158.58:8000)
I (7073) HOTPIN_MAIN: Initializing STT pipeline...
I (7079) STT: Initializing STT pipeline...
I (7084) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7102) STT: â•‘ STT Ring Buffer Allocation (PSRAM)
I (7107) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7126) STT: [MEMORY] Pre-allocation state:
I (7131) STT:   Free internal RAM: 145523 bytes
I (7136) STT:   Free DMA-capable: 126695 bytes
I (7141) STT:   Free PSRAM: 4189764 bytes
I (7146) STT: [ALLOCATION] Allocating 64 KB ring buffer in external PSRAM...
I (7153) STT:   âœ“ Ring buffer allocated at 0x3f8011c0 (PSRAM address)
I (7161) STT:   âœ“ Confirmed: Buffer is in PSRAM address range (0x3F800000-0x3FC00000)
I (7169) STT: [MEMORY] Post-allocation state:
I (7174) STT:   Free internal RAM: 145523 bytes
I (7180) STT:   Free DMA-capable: 126695 bytes
I (7185) STT:   Free PSRAM: 4124224 bytes
I (7196) STT: [CORE AFFINITY] Creating persistent audio streaming task on Core 0
I (7198) STT: Persistent audio streaming task started on Core 0
I (7204) STT:   âœ“ Stream buffer allocated at 0x3ffd3904
I (7210) STT: âœ… STT pipeline initialized
I (7215) HOTPIN_MAIN: Initializing TTS decoder...
I (7220) TTS: Initializing TTS decoder...
I (7225) WEBSOCKET: Audio callback registered
I (7230) TTS: âœ… TTS decoder initialized
I (7235) HOTPIN_MAIN: Camera and audio initialization deferred to state manager
I (7243) HOTPIN_MAIN: Creating FreeRTOS tasks...
I (7248) HOTPIN_MAIN: State manager task created on Core 1
I (7248) STATE_MGR: State manager task started on Core 1
I (7254) HOTPIN_MAIN: WebSocket connection task started on Core 0
I (7260) STATE_MGR: Priority: 10
I (7267) HOTPIN_MAIN: ğŸ”Œ Attempting WebSocket connection (attempt 1)...
I (7271) STATE_MGR: Starting in camera mode...
I (7278) WEBSOCKET: Connecting to WebSocket server...
I (7283) STATE_MGR: === TRANSITION TO CAMERA MODE ===
I (7295) STATE_MGR: Acquiring I2S mutex...
I (7297) websocket_client: Started
I (7300) STATE_MGR: Audio drivers already inactive; skipping deinit
I (7304) WEBSOCKET: WebSocket client started
I (7311) STATE_MGR: Initializing camera...
I (7254) HOTPIN_MAIN: WebSocket connection task created on Core 0
I (7320) CAMERA: Initializing camera...
I (7327) HOTPIN_MAIN: Initializing task watchdog (30s timeout)...
I (7332) CAMERA: GPIO ISR service already active (shared)
I (7345) gpio: GPIO[25]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:2
I (7340) HOTPIN_MAIN: State manager task added to watchdog
E (7354) gpio: gpio_install_isr_service(503): GPIO isr service already installed
I (7360) HOTPIN_MAIN: ====================================
I (7369) cam_hal: cam init ok
I (7374) HOTPIN_MAIN: System initialization complete!
I (7379) sccb-ng: pin_sda 26 pin_scl 27
I (7384) HOTPIN_MAIN: Entering camera standby mode...
I (7388) sccb-ng: sccb_i2c_port=1
I (7394) HOTPIN_MAIN: ====================================
I (7399) gpio: GPIO[32]| InputEn: 0| OutputEn: 1| OpenDrain: 0| Pullup: 0| Pulldown: 0| Intr:0
I (7447) camera: Camera PID=0x26 VER=0x42 MIDL=0x7f MIDH=0xa2
I (7447) camera: Detected OV2640 camera
I (7447) camera: Detected camera at address=0x30
I (7527) cam_hal: PSRAM DMA mode disabled
I (7528) cam_hal: buffer_size: 32768, half_buffer_size: 4096, node_buffer_size: 2048, node_cnt: 16, total_cnt: 15
I (7532) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (7538) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (7545) cam_hal: cam config ok
I (7549) ov2640: Set PLL: clk_2x: 0, clk_div: 0, pclk_auto: 0, pclk_div: 8
I (7632) CAMERA: Camera initialized successfully
I (7632) STATE_MGR: I2S mutex released
I (7633) STATE_MGR: âœ… Camera mode transition complete
I (7632) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7637) STATE_MGR: âœ… Entered CAMERA_STANDBY state
I (7655) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (7660) LED_CTRL: LED pattern -> 3
I (7667) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7689) AUDIO: [MUTEX] Creating I2S access mutex for thread safety...
I (7697) AUDIO:   âœ“ I2S access mutex created successfully
I (7703) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7721) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (7728) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (7746) AUDIO: [DIAG] Pre-init state:
I (7750) AUDIO:   Free heap: 4050396 bytes
I (7755) AUDIO:   Free internal RAM: 69459 bytes
I (7760) AUDIO:   Free DMA-capable: 50127 bytes
I (7766) AUDIO:   Free PSRAM: 3999772 bytes
I (7768) wifi:I (7770) AUDIO:   Timestamp: 6223 ms
I (7776) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (7783) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (7791) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (7799) AUDIO:   DMA frame num (per desc): 1020
I (7804) AUDIO:   DMA total samples (effective): 4080
I (7810) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (7817) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (7823) AUDIO: âœ… I2S channels created (took 0 ms)
I (7828) AUDIO:   TX handle: 0x3ffe3c38 | RX handle: 0x3ffe3de8
I (7835) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
<ba-add>idx:0 (ifx:0, 2a:2f:0f:5c:80:a1), tid:0, ssn:4, winSize:64
I (7841) AUDIO:   Sample rate: 16000 Hz
I (7852) AUDIO:   MCLK: DISABLED
I (7856) AUDIO:   BCLK: GPIO14 (shared)
I (7860) AUDIO:   WS:   GPIO15 (shared)
I (7865) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (7873) AUDIO: âœ… TX channel configured (took 2 ms)
I (7874) WEBSOCKET: âœ… WebSocket connected to server
I (7876) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (7882) WEBSOCKET: Sending handshake: {"session_id":"esp32-cam-hotpin"}
I (7889) AUDIO:   Sample rate: 16000 Hz
I (7899) WEBSOCKET: Handshake sent successfully
I (7900) AUDIO:   MCLK: DISABLED
I (7906) HOTPIN_MAIN: ğŸ‰ WebSocket status callback: CONNECTED
I (7910) AUDIO:   BCLK: GPIO14 (shared)
I (7909) STATE_MGR: WebSocket connected
I (7921) AUDIO:   WS:   GPIO15 (shared)
I (7930) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (7936) AUDIO: âœ… RX channel configured (took 0 ms)
I (7941) AUDIO: [STEP 4/6] Enabling TX channel...
I (7946) AUDIO: âœ… TX channel enabled (took 0 ms)
I (7952) AUDIO: [STEP 5/6] Enabling RX channel...
I (7957) AUDIO: âœ… RX channel enabled (took 0 ms)
I (7963) AUDIO: [STEP 6/6] Hardware stabilization...
I (7968) AUDIO:   Phase 1: Initial settle (50ms)
I (7992) WEBSOCKET: Received text message: {"status": "connected", "session_id": "esp32-cam-hotpin"}
I (7992) WEBSOCKET: Server status: connected
I (8024) AUDIO:   Phase 2: DMA verification
I (8024) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (8024) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (8076) HOTPIN_MAIN: ğŸ‰ WebSocket connected and verified!
I (8076) HOTPIN_MAIN: ğŸ“¡ WebSocket connection active - entering monitor loop
I (8181) AUDIO: [DIAG] Post-init state:
I (8181) AUDIO:   Free heap: 4024084 bytes
I (8181) AUDIO:   Free internal RAM: 43147 bytes
I (8184) AUDIO:   Free DMA-capable: 24319 bytes
I (8190) AUDIO:   Free PSRAM: 3999772 bytes
I (8194) AUDIO:   Timestamp: 6647 ms
I (8199) AUDIO:   Total init time: 202 ms
I (8203) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (8221) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (8227) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (8233) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (8241) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (8248) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (8266) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (8284) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (8290) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (8296) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (8303) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (8309) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9593) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9600) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (9607) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9625) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (9632) AUDIO: âœ… RX channel disabled (took 0 ms)
I (9637) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (9644) AUDIO: âœ… TX channel disabled (took 0 ms)
I (9649) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (9706) AUDIO: [STEP 4/5] Deleting RX channel...
I (9706) AUDIO: âœ… RX channel deleted (took 0 ms)
I (9706) AUDIO: [STEP 5/5] Deleting TX channel...
I (9711) AUDIO: âœ… TX channel deleted (took 0 ms)
I (9716) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (9774) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9780) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (9787) AUDIO: â•‘ Camera Can Now Initialize
I (9792) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (9811) HOTPIN_MAIN: Main task exiting - system running
I (9816) main_task: Returned from app_main()
ğŸ“¢ Voice mode STARTED (recording...)
I (20867) STATE_MGR: Button event received: 1 in state CAMERA_STANDBY
I (20867) SERIAL_CMD: Simulated SHORT PRESS - Voice START
I (20868) STATE_MGR: Single click - mode toggle requested
I (20879) STATE_MGR: Switching: Camera â†’ Voice (count: 1)
I (20885) STATE_MGR: === TRANSITION TO VOICE MODE ===
I (20891) STATE_MGR: Stopping camera...
I (20896) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (20912) STATE_MGR: â•‘ STEP 2: Acquiring I2S configuration mutex
I (20919) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (20935) STATE_MGR:   Timeout: 5000 ms
I (20939) STATE_MGR:   Timestamp: 19392 ms
I (20944) STATE_MGR:   âœ“ Mutex acquired (took 0 ms)
I (20950) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (20966) STATE_MGR: â•‘ STEP 3: Deinitializing camera hardware
I (20973) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (20989) STATE_MGR:   Free heap before: 4054884 bytes
I (20995) STATE_MGR:   Free PSRAM before: 3999772 bytes
I (21001) CAMERA: Deinitializing camera...
I (21006) CAMERA: Camera deinitialized
I (21010) STATE_MGR:   âœ“ Camera deinitialized (took 9 ms)
I (21016) STATE_MGR:   Free heap after: 4217288 bytes
I (21022) STATE_MGR:   Free PSRAM after: 4124088 bytes
I (21028) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21044) STATE_MGR: â•‘ HARDWARE STABILIZATION - CRITICAL
I (21050) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21066) STATE_MGR:   Phase 1: Initial settle (100ms) - Free camera interrupts
I (21174) STATE_MGR:   Phase 2: GPIO matrix settle (100ms) - Reconfigure pins
I (21274) STATE_MGR:   Phase 3: Final settle (50ms) - Stabilize state
I (21324) STATE_MGR:   âœ“ Total stabilization: 250ms
I (21324) STATE_MGR:   Timestamp: 19777 ms
I (21324) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21340) STATE_MGR: â•‘ STEP 4: Initializing I2S audio drivers
I (21347) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21363) STATE_MGR:   Free heap before: 4217288 bytes
I (21369) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21387) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (21394) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21412) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21430) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (21437) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21455) AUDIO: [DIAG] Pre-init state:
I (21459) AUDIO:   Free heap: 4217288 bytes
I (21464) AUDIO:   Free internal RAM: 112035 bytes
I (21470) AUDIO:   Free DMA-capable: 93207 bytes
I (21475) AUDIO:   Free PSRAM: 4124088 bytes
I (21480) AUDIO:   Timestamp: 19933 ms
I (21484) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (21491) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (21499) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (21507) AUDIO:   DMA frame num (per desc): 1020
I (21513) AUDIO:   DMA total samples (effective): 4080
I (21519) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (21526) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (21532) AUDIO: âœ… I2S channels created (took 0 ms)
I (21537) AUDIO:   TX handle: 0x3ffafc50 | RX handle: 0x3ffca690
I (21544) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (21551) AUDIO:   Sample rate: 16000 Hz
I (21555) AUDIO:   MCLK: DISABLED
I (21559) AUDIO:   BCLK: GPIO14 (shared)
I (21564) AUDIO:   WS:   GPIO15 (shared)
I (21569) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (21575) AUDIO: âœ… TX channel configured (took 1 ms)
I (21580) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (21587) AUDIO:   Sample rate: 16000 Hz
I (21591) AUDIO:   MCLK: DISABLED
I (21595) AUDIO:   BCLK: GPIO14 (shared)
I (21600) AUDIO:   WS:   GPIO15 (shared)
I (21605) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (21611) AUDIO: âœ… RX channel configured (took 0 ms)
I (21616) AUDIO: [STEP 4/6] Enabling TX channel...
I (21622) AUDIO: âœ… TX channel enabled (took 0 ms)
I (21627) AUDIO: [STEP 5/6] Enabling RX channel...
I (21633) AUDIO: âœ… RX channel enabled (took 0 ms)
I (21638) AUDIO: [STEP 6/6] Hardware stabilization...
I (21644) AUDIO:   Phase 1: Initial settle (50ms)
I (21699) AUDIO:   Phase 2: DMA verification
I (21699) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (21700) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (21857) AUDIO: [DIAG] Post-init state:
I (21857) AUDIO:   Free heap: 4191312 bytes
I (21857) AUDIO:   Free internal RAM: 86059 bytes
I (21861) AUDIO:   Free DMA-capable: 67231 bytes
I (21866) AUDIO:   Free PSRAM: 4124088 bytes
I (21871) AUDIO:   Timestamp: 20324 ms
I (21876) AUDIO:   Total init time: 201 ms
I (21880) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21898) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (21905) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (21910) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (21919) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (21925) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21943) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (21961) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (21968) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (21974) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (21981) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (21987) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22005) STATE_MGR:   âœ“ Audio initialized (took 636 ms)
I (22011) STATE_MGR:   Free heap after: 4191312 bytes
I (22017) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22033) STATE_MGR: â•‘ STEP 5: I2S mutex released
I (22039) STATE_MGR: â•‘ Total transition time: 895 ms
I (22045) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22061) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22077) STATE_MGR: â•‘ STEP 6: Starting STT/TTS pipelines
I (22084) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22100) STT: Starting STT pipeline...
I (22104) STT: [CORE AFFINITY] Creating audio capture task on Core 0 (co-located with Wi-Fi)
I (22114) STT: âœ… STT pipeline started
I (22113) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22118) TTS: Starting TTS decoder...
I (22114) STT: Audio streaming session activated
I (22139) TTS: Initializing TTS decoder...
I (22134) STT: â•‘ Audio Capture Task Started on Core 0
W (22149) TTS: TTS decoder already initialized
I (22144) STT: Starting audio streaming to server...
I (22160) TTS: [CORE AFFINITY] Creating TTS playback task on Core 0 (co-located with Wi-Fi and STT)
I (22155) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22175) TTS: âœ… TTS decoder started
I (22191) STT: [STABILIZATION] Phase 1: Waiting 200ms for I2S DMA...
I (22203) STT:   Current time: 20655 ms
I (22207) STT:   Free heap: 4182400 bytes
I (22191) TTS: TTS playback task started on Core 0
I (22412) STT: [STABILIZATION] Phase 2: Verify audio driver state...
I (22412) STT:   âœ“ Audio driver initialized
I (22413) STT: [STABILIZATION] Phase 3: Additional 100ms settle...
I (22471) LED_CTRL: LED pattern -> 1
I (22472) STATE_MGR: âœ… Voice mode transition complete
I (22472) STATE_MGR: âœ… Entered VOICE_ACTIVE state
I (22486) STATE_MGR: STT pipeline reported start
I (22496) STATE_MGR: TTS playback start event received
I (22520) STT:   Total stabilization: 300ms
I (22520) STT:   Timestamp: 20973 ms
I (22520) STT: [BUFFER] Allocating 1024 byte capture buffer...
I (22524) STT:   âœ“ DMA-capable buffer allocated at 0x3fff26f0
I (22531) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22547) STT: â•‘ ğŸ¤ STARTING AUDIO CAPTURE
I (22552) STT: â•‘ Chunk size: 1024 bytes | Timeout: 100 ms
I (22559) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (22575) STT: [FIRST READ] Completed:
I (22579) STT:   Result: ESP_OK
I (22583) STT:   Bytes read: 1024 / 1024
I (22588) STT:   Duration: 0 ms
I (22591) STT:   Timestamp: 21028 ms
I (22597) STT:   First 16 bytes: 6b ff 47 ff 68 ff 6b ff 6b ff 68 ff a4 ff 6b ff
I (22717) STT: [CAPTURE] Read #10: 1024 bytes (total: 10240 bytes, 10.0 KB)
I (22718) STT:   Avg read time: 63 ms | Errors: 0
E (22926) transport_ws: Error transport_poll_write
E (22927) websocket_client: esp_transport_write() returned 0, transport_error=ESP_OK, tls_error_code=0, tls_flags=0, errno=0
E (22933) WEBSOCKET: âŒ WebSocket error occurred
E (22938) HOTPIN_MAIN: âŒ WebSocket status callback: ERROR
E (22946) STATE_MGR: WebSocket error signalled
I (22949) LED_CTRL: LED pattern -> 5
E (22949) transport_base: tcp_read error, errno=Socket is not connected
I (22950) websocket_client: Reconnect after 5000 ms
E (22961) transport_ws: Error read data
W (22967) WEBSOCKET: âš ï¸ WebSocket disconnected
E (22971) websocket_client: esp_transport_read() failed with -2, transport_error=ESP_OK, tls_error_code=0, tls_flags=0, errno=128
W (22976) STATE_MGR: WebSocket disconnected
W (22976) HOTPIN_MAIN: âš ï¸ WebSocket status callback: DISCONNECTED
I (22994) LED_CTRL: LED pattern -> 4
E (23001) WEBSOCKET: âŒ WebSocket error occurred
E (23010) HOTPIN_MAIN: âŒ WebSocket status callback: ERROR
E (23015) STATE_MGR: WebSocket error signalled
E (23018) websocket_client: Error receive data
I (23022) LED_CTRL: LED pattern -> 5
I (23027) websocket_client: Reconnect after 5000 ms
W (23037) WEBSOCKET: âš ï¸ WebSocket disconnected
W (23042) STATE_MGR: WebSocket disconnected
W (23042) HOTPIN_MAIN: âš ï¸ WebSocket status callback: DISCONNECTED
I (23047) LED_CTRL: LED pattern -> 4
E (23001) STT: WebSocket disconnected during streaming
I (23064) STT: Streaming task received stop signal
W (23070) STT: Audio streaming aborted due to transport errors
W (23076) STT: Skipping EOS - WebSocket disconnected
I (23082) STT: Audio streaming session complete (streamed 8192 bytes in 2 chunks)
I (23043) STT: [CAPTURE] Read #20: 1024 bytes (total: 20480 bytes, 20.0 KB)
I (23090) STATE_MGR: STT pipeline reported stop
I (23098) STT:   Avg read time: 65 ms | Errors: 0
I (23103) LED_CTRL: LED pattern -> 1
I (23109) STT: Audio capture task stopped (captured 20480 bytes total)
I (25606) STATE_MGR: Button event received: 1 in state VOICE_ACTIVE
ğŸ”‡ Voice mode STOPPED
W (25607) STATE_MGR: Guardrail soft override: stopping voice pipeline while busy
I (25607) SERIAL_CMD: Simulated SHORT PRESS - Voice STOP
I (25613) STATE_MGR: Single click - mode toggle requested
I (25625) STATE_MGR: Switching: Voice â†’ Camera (count: 2)
I (25631) STATE_MGR: === TRANSITION TO CAMERA MODE ===
I (25637) STATE_MGR: Stopping voice mode components...
I (25643) STT: Stopping STT pipeline...
W (25647) STT: STT pipeline already stopped
I (27152) STATE_MGR: Voice pipeline became idle at stage idle
I (27152) TTS: Stopping TTS decoder...
I (27153) TTS: Playback stop signal received
I (27157) TTS: TTS playback task stopped
I (27163) TTS: TTS decoder stopped (played 0 bytes)
I (27267) STATE_MGR: Acquiring I2S mutex...
I (27267) STATE_MGR: Deinitializing audio drivers...
I (27267) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (27285) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (27292) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (27310) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (27317) AUDIO: âœ… RX channel disabled (took 0 ms)
I (27323) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (27329) AUDIO: âœ… TX channel disabled (took 0 ms)
I (27335) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (27391) AUDIO: [STEP 4/5] Deleting RX channel...
I (27392) AUDIO: âœ… RX channel deleted (took 0 ms)
I (27392) AUDIO: [STEP 5/5] Deleting TX channel...
I (27397) AUDIO: âœ… TX channel deleted (took 0 ms)
I (27402) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (27460) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (27467) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (27474) AUDIO: â•‘ Camera Can Now Initialize
I (27479) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (27497) STATE_MGR: Initializing camera...
I (27501) CAMERA: Initializing camera...
I (27506) gpio: GPIO[25]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:2
E (27516) gpio: gpio_install_isr_service(503): GPIO isr service already installed
I (27524) cam_hal: cam init ok
W (27528) ledc: GPIO 0 is not usable, maybe conflict with others
I (27534) sccb-ng: pin_sda 26 pin_scl 27
I (27539) sccb-ng: sccb_i2c_port=1
I (27544) gpio: GPIO[32]| InputEn: 0| OutputEn: 1| OpenDrain: 0| Pullup: 0| Pulldown: 0| Intr:0
I (27586) camera: Camera PID=0x26 VER=0x42 MIDL=0x7f MIDH=0xa2
I (27586) camera: Detected OV2640 camera
I (27586) camera: Detected camera at address=0x30
I (27667) cam_hal: PSRAM DMA mode disabled
I (27667) cam_hal: buffer_size: 32768, half_buffer_size: 4096, node_buffer_size: 2048, node_cnt: 16, total_cnt: 15
I (27672) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (27678) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (27685) cam_hal: cam config ok
I (27689) ov2640: Set PLL: clk_2x: 0, clk_div: 0, pclk_auto: 0, pclk_div: 8
I (27771) CAMERA: Camera initialized successfully
I (27771) STATE_MGR: I2S mutex released
I (27771) STATE_MGR: âœ… Camera mode transition complete
I (27776) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (27794) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (27801) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (27819) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (27837) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (27844) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (27862) AUDIO: [DIAG] Pre-init state:
I (27867) AUDIO:   Free heap: 4054956 bytes
I (27872) AUDIO:   Free internal RAM: 73915 bytes
I (27877) AUDIO:   Free DMA-capable: 55087 bytes
I (27882) AUDIO:   Free PSRAM: 3999908 bytes
I (27887) AUDIO:   Timestamp: 26340 ms
I (27892) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (27898) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (27906) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (27915) AUDIO:   DMA frame num (per desc): 1020
I (27920) AUDIO:   DMA total samples (effective): 4080
I (27926) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (27933) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (27939) AUDIO: âœ… I2S channels created (took 0 ms)
I (27945) AUDIO:   TX handle: 0x3ffcb5bc | RX handle: 0x3ffca8b4
I (27951) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (27958) AUDIO:   Sample rate: 16000 Hz
I (27963) AUDIO:   MCLK: DISABLED
I (27967) AUDIO:   BCLK: GPIO14 (shared)
I (27971) AUDIO:   WS:   GPIO15 (shared)
I (27976) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (27982) AUDIO: âœ… TX channel configured (took 1 ms)
I (27987) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (27994) AUDIO:   Sample rate: 16000 Hz
I (27999) AUDIO:   MCLK: DISABLED
I (28003) AUDIO:   BCLK: GPIO14 (shared)
I (28007) AUDIO:   WS:   GPIO15 (shared)
I (28012) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (28018) AUDIO: âœ… RX channel configured (took 0 ms)
I (28023) AUDIO: [STEP 4/6] Enabling TX channel...
I (28029) AUDIO: âœ… TX channel enabled (took 0 ms)
I (28034) AUDIO: [STEP 5/6] Enabling RX channel...
I (28040) AUDIO: âœ… RX channel enabled (took 0 ms)
I (28045) AUDIO: [STEP 6/6] Hardware stabilization...
I (28051) AUDIO:   Phase 1: Initial settle (50ms)
W (28079) HOTPIN_MAIN: WebSocket disconnected - restarting connection sequence
I (28079) HOTPIN_MAIN: ğŸ”Œ Attempting WebSocket connection (attempt 1)...
I (28083) WEBSOCKET: Connecting to WebSocket server...
E (28089) websocket_client: The client has started
E (28095) WEBSOCKET: Failed to start WebSocket client: ESP_FAIL
E (28101) HOTPIN_MAIN: âŒ WebSocket connection failed: ESP_FAIL
I (28106) AUDIO:   Phase 2: DMA verification
I (28113) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (28119) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (28276) AUDIO: [DIAG] Post-init state:
I (28277) AUDIO:   Free heap: 4026868 bytes
I (28277) AUDIO:   Free internal RAM: 45963 bytes
I (28280) AUDIO:   Free DMA-capable: 27135 bytes
I (28286) AUDIO:   Free PSRAM: 3999772 bytes
I (28291) AUDIO:   Timestamp: 26743 ms
I (28295) AUDIO:   Total init time: 201 ms
I (28300) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (28318) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (28324) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (28329) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (28338) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (28345) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (28363) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (28381) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (28387) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (28394) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (28401) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (28407) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (28451) WEBSOCKET: âœ… WebSocket connected to server
I (28451) WEBSOCKET: Sending handshake: {"session_id":"esp32-cam-hotpin"}
I (28457) WEBSOCKET: Handshake sent successfully
I (28459) HOTPIN_MAIN: ğŸ‰ WebSocket status callback: CONNECTED
I (28508) HOTPIN_MAIN: ğŸ‰ WebSocket connected and verified!
I (28508) HOTPIN_MAIN: ğŸ“¡ WebSocket connection active - entering monitor loop
I (28708) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (28715) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (28723) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (28741) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (28748) AUDIO: âœ… RX channel disabled (took 0 ms)
I (28753) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (28760) AUDIO: âœ… TX channel disabled (took 0 ms)
I (28765) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (28822) AUDIO: [STEP 4/5] Deleting RX channel...
I (28823) AUDIO: âœ… RX channel deleted (took 0 ms)
I (28823) AUDIO: [STEP 5/5] Deleting TX channel...
I (28828) AUDIO: âœ… TX channel deleted (took 0 ms)
I (28833) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (28858) WEBSOCKET: Received text message: {"status": "connected", "session_id": "esp32-cam-hotpin"}
I (28859) WEBSOCKET: Server status: connected
I (28891) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (28898) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (28905) AUDIO: â•‘ Camera Can Now Initialize
I (28910) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (28928) LED_CTRL: LED pattern -> 3
I (28932) STATE_MGR: âœ… Entered CAMERA_STANDBY state
I (28948) STATE_MGR: TTS playback finished successfully
I (28959) STATE_MGR: WebSocket connected
ğŸ“¢ Voice mode STARTED (recording...)
I (34981) STATE_MGR: Button event received: 1 in state CAMERA_STANDBY
I (34981) SERIAL_CMD: Simulated SHORT PRESS - Voice START
I (34981) STATE_MGR: Single click - mode toggle requested
I (34993) STATE_MGR: Switching: Camera â†’ Voice (count: 3)
I (34999) STATE_MGR: === TRANSITION TO VOICE MODE ===
I (35004) STATE_MGR: Stopping camera...
I (35009) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35025) STATE_MGR: â•‘ STEP 2: Acquiring I2S configuration mutex
I (35032) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35048) STATE_MGR:   Timeout: 5000 ms
I (35053) STATE_MGR:   Timestamp: 33506 ms
I (35058) STATE_MGR:   âœ“ Mutex acquired (took 0 ms)
I (35063) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35080) STATE_MGR: â•‘ STEP 3: Deinitializing camera hardware
I (35086) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35102) STATE_MGR:   Free heap before: 4054396 bytes
I (35108) STATE_MGR:   Free PSRAM before: 3999772 bytes
I (35114) CAMERA: Deinitializing camera...
I (35120) CAMERA: Camera deinitialized
I (35123) STATE_MGR:   âœ“ Camera deinitialized (took 9 ms)
I (35130) STATE_MGR:   Free heap after: 4216688 bytes
I (35135) STATE_MGR:   Free PSRAM after: 4124088 bytes
I (35141) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35157) STATE_MGR: â•‘ HARDWARE STABILIZATION - CRITICAL
I (35164) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35180) STATE_MGR:   Phase 1: Initial settle (100ms) - Free camera interrupts
I (35288) STATE_MGR:   Phase 2: GPIO matrix settle (100ms) - Reconfigure pins
I (35388) STATE_MGR:   Phase 3: Final settle (50ms) - Stabilize state
I (35438) STATE_MGR:   âœ“ Total stabilization: 250ms
I (35438) STATE_MGR:   Timestamp: 33891 ms
I (35438) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35454) STATE_MGR: â•‘ STEP 4: Initializing I2S audio drivers
I (35461) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35477) STATE_MGR:   Free heap before: 4216688 bytes
I (35483) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35501) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (35508) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35526) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35544) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (35551) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (35569) AUDIO: [DIAG] Pre-init state:
I (35573) AUDIO:   Free heap: 4216688 bytes
I (35578) AUDIO:   Free internal RAM: 111563 bytes
I (35584) AUDIO:   Free DMA-capable: 92735 bytes
I (35589) AUDIO:   Free PSRAM: 4124088 bytes
I (35594) AUDIO:   Timestamp: 34047 ms
I (35598) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (35605) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (35613) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (35621) AUDIO:   DMA frame num (per desc): 1020
I (35627) AUDIO:   DMA total samples (effective): 4080
I (35633) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (35640) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (35646) AUDIO: âœ… I2S channels created (took 0 ms)
I (35651) AUDIO:   TX handle: 0x3ffafc50 | RX handle: 0x3ffcb490
I (35658) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (35665) AUDIO:   Sample rate: 16000 Hz
I (35669) AUDIO:   MCLK: DISABLED
I (35673) AUDIO:   BCLK: GPIO14 (shared)
I (35678) AUDIO:   WS:   GPIO15 (shared)
I (35683) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (35689) AUDIO: âœ… TX channel configured (took 1 ms)
I (35694) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (35701) AUDIO:   Sample rate: 16000 Hz
I (35705) AUDIO:   MCLK: DISABLED
I (35709) AUDIO:   BCLK: GPIO14 (shared)
I (35714) AUDIO:   WS:   GPIO15 (shared)
I (35719) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (35725) AUDIO: âœ… RX channel configured (took 0 ms)
I (35730) AUDIO: [STEP 4/6] Enabling TX channel...
I (35736) AUDIO: âœ… TX channel enabled (took 0 ms)
I (35741) AUDIO: [STEP 5/6] Enabling RX channel...
I (35747) AUDIO: âœ… RX channel enabled (took 0 ms)
I (35752) AUDIO: [STEP 6/6] Hardware stabilization...
I (35758) AUDIO:   Phase 1: Initial settle (50ms)
I (35813) AUDIO:   Phase 2: DMA verification
I (35813) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (35814) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (35971) AUDIO: [DIAG] Post-init state:
I (35971) AUDIO:   Free heap: 4190700 bytes
I (35971) AUDIO:   Free internal RAM: 85575 bytes
I (35975) AUDIO:   Free DMA-capable: 66747 bytes
I (35980) AUDIO:   Free PSRAM: 4124088 bytes
I (35985) AUDIO:   Timestamp: 34438 ms
I (35990) AUDIO:   Total init time: 201 ms
I (35994) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36012) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (36019) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (36024) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (36033) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (36039) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36057) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36075) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (36082) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (36088) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (36095) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (36101) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36119) STATE_MGR:   âœ“ Audio initialized (took 636 ms)
I (36125) STATE_MGR:   Free heap after: 4190700 bytes
I (36131) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36147) STATE_MGR: â•‘ STEP 5: I2S mutex released
I (36153) STATE_MGR: â•‘ Total transition time: 895 ms
I (36159) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36175) STATE_MGR: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36191) STATE_MGR: â•‘ STEP 6: Starting STT/TTS pipelines
I (36197) STATE_MGR: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36214) STT: Starting STT pipeline...
I (36218) STT: [CORE AFFINITY] Creating audio capture task on Core 0 (co-located with Wi-Fi)
I (36227) STT: âœ… STT pipeline started
I (36227) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36232) TTS: Starting TTS decoder...
I (36228) STT: Audio streaming session activated
I (36253) TTS: Initializing TTS decoder...
I (36248) STT: â•‘ Audio Capture Task Started on Core 0
W (36263) TTS: TTS decoder already initialized
I (36258) STT: Starting audio streaming to server...
I (36274) TTS: [CORE AFFINITY] Creating TTS playback task on Core 0 (co-located with Wi-Fi and STT)
I (36269) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36289) TTS: âœ… TTS decoder started
I (36305) STT: [STABILIZATION] Phase 1: Waiting 200ms for I2S DMA...
I (36317) STT:   Current time: 34769 ms
I (36321) STT:   Free heap: 4181788 bytes
I (36305) TTS: TTS playback task started on Core 0
ğŸ”‡ Voice mode STOPPED
I (36492) SERIAL_CMD: Simulated SHORT PRESS - Voice STOP
I (36526) STT: [STABILIZATION] Phase 2: Verify audio driver state...
I (36526) STT:   âœ“ Audio driver initialized
I (36526) STT: [STABILIZATION] Phase 3: Additional 100ms settle...
I (36585) LED_CTRL: LED pattern -> 1
I (36586) STATE_MGR: âœ… Voice mode transition complete
I (36586) STATE_MGR: âœ… Entered VOICE_ACTIVE state
I (36600) STATE_MGR: STT pipeline reported start
I (36610) STATE_MGR: TTS playback start event received
I (36620) STATE_MGR: Button event received: 1 in state VOICE_ACTIVE
W (36620) STATE_MGR: Guardrail soft override: stopping voice pipeline while busy
I (36624) STATE_MGR: Single click - mode toggle requested
I (36630) STATE_MGR: Switching: Voice â†’ Camera (count: 4)
I (36633) STT:   Total stabilization: 300ms
I (36637) STATE_MGR: === TRANSITION TO CAMERA MODE ===
I (36641) STT:   Timestamp: 35094 ms
I (36647) STATE_MGR: Stopping voice mode components...
I (36652) STT: [BUFFER] Allocating 1024 byte capture buffer...
I (36657) STT: Stopping STT pipeline...
I (36664) STT:   âœ“ DMA-capable buffer allocated at 0x3fff26f0
I (36675) STT: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36691) STT: â•‘ ğŸ¤ STARTING AUDIO CAPTURE
I (36696) STT: â•‘ Chunk size: 1024 bytes | Timeout: 100 ms
I (36703) STT: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (36719) STT: Audio capture task stopped (captured 0 bytes total)
I (36679) STT: Capture stopped and ring buffer drained; ending streaming loop
I (36733) STT: Streaming task received stop signal
I (36739) STT: Sending EOS signal...
I (36743) WEBSOCKET: Sending EOS signal
I (36753) STT: Audio streaming session complete (streamed 0 bytes in 0 chunks)
I (36766) STT: STT pipeline stopped
I (38266) STATE_MGR: Voice pipeline became idle at stage idle
I (38266) TTS: Stopping TTS decoder...
I (38267) TTS: Playback stop signal received
I (38271) TTS: TTS playback task stopped
I (38277) TTS: TTS decoder stopped (played 0 bytes)
I (38381) STATE_MGR: Acquiring I2S mutex...
I (38381) STATE_MGR: Deinitializing audio drivers...
I (38381) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (38399) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (38406) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (38424) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (38431) AUDIO: âœ… RX channel disabled (took 0 ms)
I (38437) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (38443) AUDIO: âœ… TX channel disabled (took 0 ms)
I (38449) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (38505) AUDIO: [STEP 4/5] Deleting RX channel...
I (38506) AUDIO: âœ… RX channel deleted (took 0 ms)
I (38506) AUDIO: [STEP 5/5] Deleting TX channel...
I (38511) AUDIO: âœ… TX channel deleted (took 0 ms)
I (38516) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (38574) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (38581) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (38588) AUDIO: â•‘ Camera Can Now Initialize
I (38593) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (38611) STATE_MGR: Initializing camera...
I (38616) CAMERA: Initializing camera...
I (38620) gpio: GPIO[25]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:2
E (38630) gpio: gpio_install_isr_service(503): GPIO isr service already installed
I (38638) cam_hal: cam init ok
W (38642) ledc: GPIO 0 is not usable, maybe conflict with others
I (38648) sccb-ng: pin_sda 26 pin_scl 27
I (38653) sccb-ng: sccb_i2c_port=1
I (38658) gpio: GPIO[32]| InputEn: 0| OutputEn: 1| OpenDrain: 0| Pullup: 0| Pulldown: 0| Intr:0
I (38700) camera: Camera PID=0x26 VER=0x42 MIDL=0x7f MIDH=0xa2
I (38700) camera: Detected OV2640 camera
I (38700) camera: Detected camera at address=0x30
I (38780) cam_hal: PSRAM DMA mode disabled
I (38781) cam_hal: buffer_size: 32768, half_buffer_size: 4096, node_buffer_size: 2048, node_cnt: 16, total_cnt: 15
I (38785) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (38792) cam_hal: Allocating 61440 Byte frame buffer in PSRAM
I (38799) cam_hal: cam config ok
I (38802) ov2640: Set PLL: clk_2x: 0, clk_div: 0, pclk_auto: 0, pclk_div: 8
I (38885) CAMERA: Camera initialized successfully
I (38885) STATE_MGR: I2S mutex released
I (38885) STATE_MGR: âœ… Camera mode transition complete
I (38890) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (38908) AUDIO: â•‘ Initializing Modern I2S STD Driver (Full-Duplex)
I (38915) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (38933) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (38951) AUDIO: â•‘ Configuring Modern I2S STD Driver (Separate TX/RX)
I (38958) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (38976) AUDIO: [DIAG] Pre-init state:
I (38981) AUDIO:   Free heap: 4052832 bytes
I (38985) AUDIO:   Free internal RAM: 71927 bytes
I (38991) AUDIO:   Free DMA-capable: 53099 bytes
I (38996) AUDIO:   Free PSRAM: 3999772 bytes
I (39001) AUDIO:   Timestamp: 37454 ms
I (39006) AUDIO: [STEP 1/6] Creating I2S channel pair (TX + RX)...
I (39012) AUDIO:   Using I2S controller 1 for both channels (full-duplex mode)
I (39020) AUDIO:   DMA config request: 4 buffers x 1020 samples (requested = 4080)
I (39029) AUDIO:   DMA frame num (per desc): 1020
I (39034) AUDIO:   DMA total samples (effective): 4080
I (39040) AUDIO:   DMA memory committed: 8160 bytes (2 bytes/sample)
I (39047) AUDIO:   DMA memory: 8160 bytes (2 bytes/sample)
I (39053) AUDIO: âœ… I2S channels created (took 0 ms)
I (39059) AUDIO:   TX handle: 0x3ffcb554 | RX handle: 0x3ffca854
I (39065) AUDIO: [STEP 2/6] Configuring TX (speaker) channel...
I (39072) AUDIO:   Sample rate: 16000 Hz
I (39077) AUDIO:   MCLK: DISABLED
I (39081) AUDIO:   BCLK: GPIO14 (shared)
I (39085) AUDIO:   WS:   GPIO15 (shared)
I (39090) AUDIO:   DOUT: GPIO13 (MAX98357A speaker)
I (39097) AUDIO: âœ… TX channel configured (took 1 ms)
I (39101) AUDIO: [STEP 3/6] Configuring RX (microphone) channel...
I (39108) AUDIO:   Sample rate: 16000 Hz
I (39113) AUDIO:   MCLK: DISABLED
I (39117) AUDIO:   BCLK: GPIO14 (shared)
I (39121) AUDIO:   WS:   GPIO15 (shared)
I (39126) AUDIO:   DIN:  GPIO2 (INMP441 microphone)
I (39132) AUDIO: âœ… RX channel configured (took 0 ms)
I (39137) AUDIO: [STEP 4/6] Enabling TX channel...
I (39143) AUDIO: âœ… TX channel enabled (took 0 ms)
I (39148) AUDIO: [STEP 5/6] Enabling RX channel...
I (39154) AUDIO: âœ… RX channel enabled (took 0 ms)
I (39159) AUDIO: [STEP 6/6] Hardware stabilization...
I (39165) AUDIO:   Phase 1: Initial settle (50ms)
I (39220) AUDIO:   Phase 2: DMA verification
I (39220) AUDIO:   âœ“ DMA TX operational (128 bytes)
I (39221) AUDIO:   Phase 3: Additional settle (150ms) - CRITICAL for RX DMA
I (39378) AUDIO: [DIAG] Post-init state:
I (39379) AUDIO:   Free heap: 4026848 bytes
I (39379) AUDIO:   Free internal RAM: 45943 bytes
I (39382) AUDIO:   Free DMA-capable: 27115 bytes
I (39387) AUDIO:   Free PSRAM: 3999772 bytes
I (39392) AUDIO:   Timestamp: 37845 ms
I (39397) AUDIO:   Total init time: 201 ms
I (39402) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (39420) AUDIO: â•‘ âœ… MODERN I2S STD FULL-DUPLEX READY
I (39426) AUDIO: â•‘ Driver: i2s_std (NOT legacy!)
I (39431) AUDIO: â•‘ Mode: Master TX+RX | Rate: 16000 Hz | Format: TX stereo / RX mono
I (39440) AUDIO: â•‘ This should eliminate LoadStoreError crashes!
I (39447) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (39465) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (39483) AUDIO: â•‘ âœ… MODERN I2S STD DRIVER INITIALIZED
I (39489) AUDIO: â•‘ Mode: Full-duplex (separate TX + RX channels)
I (39496) AUDIO: â•‘ TX (Speaker): GPIO13 | RX (Microphone): GPIO2
I (39502) AUDIO: â•‘ Shared Clock: BCLK=GPIO14, WS=GPIO15
I (39509) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (39809) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (39816) AUDIO: â•‘ Deinitializing Modern I2S STD Driver for Camera Capture
I (39824) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (39842) AUDIO: [STEP 1/5] Disabling RX (microphone) channel...
I (39849) AUDIO: âœ… RX channel disabled (took 0 ms)
I (39854) AUDIO: [STEP 2/5] Disabling TX (speaker) channel...
I (39861) AUDIO: âœ… TX channel disabled (took 0 ms)
I (39866) AUDIO: [STEP 3/5] Waiting for DMA completion (50ms)...
I (39923) AUDIO: [STEP 4/5] Deleting RX channel...
I (39924) AUDIO: âœ… RX channel deleted (took 0 ms)
I (39924) AUDIO: [STEP 5/5] Deleting TX channel...
I (39929) AUDIO: âœ… TX channel deleted (took 0 ms)
I (39934) AUDIO: Additional settling time (50ms) for interrupt/GPIO matrix...
I (39992) AUDIO: â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (39999) AUDIO: â•‘ âœ… Modern I2S STD Driver Deinitialized
I (40006) AUDIO: â•‘ Camera Can Now Initialize
I (40011) AUDIO: â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
I (40029) LED_CTRL: LED pattern -> 3
I (40033) STATE_MGR: âœ… Entered CAMERA_STANDBY state
I (40049) STATE_MGR: STT pipeline reported stop
I (40059) STATE_MGR: TTS playback finished successfully
